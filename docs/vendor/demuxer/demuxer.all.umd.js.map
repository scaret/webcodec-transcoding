{"version":3,"file":"demuxer.all.umd.js","sources":["../src/enum/events.ts","../src/util/event-emitter.ts","../src/types/globals.ts","../src/util/is.ts","../src/util/cache-buffer.ts","../src/util/multi-map.ts","../src/util/event-manager.ts","../src/util/global.ts","../src/util/logger.ts","../src/util/stream.ts","../src/demux-facade.ts","../src/mux-error-code.ts","../src/m2t/structs/patSection.ts","../src/m2t/structs/pmtSection.ts","../src/enum/m2t-pid.ts","../src/m2t/psi.ts","../src/m2t/streams/complex.js","../src/util/platform.ts","../src/codec/aac/aac-config.ts","../src/codec/aac/aac.ts","../src/codec/adts.ts","../src/m2t/streams/adts.ts","../src/util/dv.ts","../src/codec/avc/ep3b.ts","../src/util/exp-golumb.ts","../src/codec/avc/sps.ts","../src/codec/avc/pps.ts","../src/codec/avc/sei.ts","../src/codec/avc/nalu.ts","../src/codec/avc.ts","../src/codec/avc/avc-config.ts","../src/m2t/streams/avc.ts","../src/m2t/streams/elementary.ts","../src/m2t/structs/pes.ts","../src/m2t/streams/pes.ts","../src/m2t/structs/packet.ts","../src/m2t/demux.ts","../src/mp4/mp4-inspector.ts","../src/mp4/demux.ts","../src/flv/flv-const.ts","../src/enum/flv-tag-types.ts","../src/flv/structs/flv-tag.ts","../src/flv/streams/body.ts","../src/flv/structs/flv-amf.ts","../src/flv/types/av-context.ts","../src/flv/structs/flv-tag-aac-audio-data.ts","../src/flv/structs/flv-tag-audio-data.ts","../src/flv/structs/flv-tag-avc-video-packet.ts","../src/flv/structs/flv-tag-video-data.ts","../src/flv/streams/tag.ts","../src/flv/structs/flv-head.ts","../src/flv/demux.ts"],"sourcesContent":["/**\n * @file= events.js, created at Monday, 23rd December 2019 3=47=23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nexport enum Events {\n    ERROR = 'ERROR',\n    INFO = 'INFO',\n    DATA = 'DATA',\n    DEMUX_DATA = 'DEMUX_DATA',\n    DONE = 'DONE'\n}\n","/**\n * @copyright https://github.com/nodejs/node/blob/master/lib/events.js\n */\n/* eslint-disable */\n// Copyright Joyent, Inc. and other Node contributors.\n//\n// Permission is hereby granted, free of charge, to any person obtaining a\n// copy of this software and associated documentation files (the\n// \"Software\"), to deal in the Software without restriction, including\n// without limitation the rights to use, copy, modify, merge, publish,\n// distribute, sublicense, and/or sell copies of the Software, and to permit\n// persons to whom the Software is furnished to do so, subject to the\n// following conditions:\n//\n// The above copyright notice and this permission notice shall be included\n// in all copies or substantial portions of the Software.\n//\n// THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n// OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN\n// NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM,\n// DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR\n// OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE\n// USE OR OTHER DEALINGS IN THE SOFTWARE.\n\nvar objectCreate = Object.create || objectCreatePolyfill;\nvar objectKeys = Object.keys || objectKeysPolyfill;\nvar bind = Function.prototype.bind || functionBindPolyfill;\n\n// By default Dispatchers will print a warning if more than 10 listeners are\n// added to it. This is a useful default which helps finding memory leaks.\nlet defaultMaxListeners = 10;\n\nexport default class EventEmitter {\n    static listenerCount(emitter, type) {\n        if (typeof emitter.listenerCount === 'function') {\n            return emitter.listenerCount(type);\n        } else {\n            return listenerCount.call(emitter, type);\n        }\n    }\n\n    static defaultMaxListeners: number;\n\n    _maxListeners?: number;\n    _eventsCount: number;\n    _events: any;\n\n    constructor() {\n        if (!this._events || !Object.prototype.hasOwnProperty.call(this, '_events')) {\n            this._events = objectCreate(null);\n            this._eventsCount = 0;\n        }\n\n        this._maxListeners = this._maxListeners || undefined;\n    }\n\n    // // Obviously not all Emitters should be limited to 10. This function allows\n    // // that to be increased. Set to zero for unlimited.\n    // setMaxListeners(n) {\n    //     if (typeof n !== 'number' || n < 0 || isNaN(n))\n    //         throw new TypeError('\"n\" argument must be a positive number');\n    //     this._maxListeners = n;\n    //     return this;\n    // }\n    //\n    // getMaxListeners() {\n    //     return $getMaxListeners(this);\n    // }\n\n    emit(type: string, ...rest) {\n        var er, handler, len, args, i, events;\n        var doError = type === 'error';\n\n        events = this._events;\n        if (events) doError = doError && events.error == null;\n        else if (!doError) return false;\n\n        // If there is no 'error' event listener then throw.\n        if (doError) {\n            if (arguments.length > 1) er = arguments[1];\n            if (er instanceof Error) {\n                throw er; // Unhandled 'error' event\n            } else {\n                // At least give some kind of context to the user\n                var err = new Error('Unhandled \"error\" event. (' + er + ')');\n                err['context'] = er;\n                throw err;\n            }\n        }\n\n        handler = events[type];\n\n        if (!handler) return false;\n\n        var isFn = typeof handler === 'function';\n        len = arguments.length;\n        switch (len) {\n            // fast cases\n            case 1:\n                emitNone(handler, isFn, this);\n                break;\n            case 2:\n                emitOne(handler, isFn, this, arguments[1]);\n                break;\n            case 3:\n                emitTwo(handler, isFn, this, arguments[1], arguments[2]);\n                break;\n            case 4:\n                emitThree(handler, isFn, this, arguments[1], arguments[2], arguments[3]);\n                break;\n            // slower\n            default:\n                args = new Array(len - 1);\n                for (i = 1; i < len; i++) args[i - 1] = arguments[i];\n                emitMany(handler, isFn, this, args);\n        }\n\n        return true;\n    }\n\n    on(type: string, listener: Function) {\n        return _addListener(this, type, listener);\n    }\n\n    once(type, listener) {\n        if (typeof listener !== 'function') throw new TypeError('\"listener\" argument must be a function');\n        this.on(type, _onceWrap(this, type, listener));\n        return this;\n    }\n\n    off(type, listener) {\n        return _removeListener.call(this, type, listener);\n    }\n\n    removeAllListeners(type) {\n        var listeners, events, i;\n\n        events = this._events;\n        if (!events) return this;\n\n        // not listening for off, no need to emit\n        if (!events.off) {\n            if (arguments.length === 0) {\n                this._events = objectCreate(null);\n                this._eventsCount = 0;\n            } else if (events[type]) {\n                if (--this._eventsCount === 0) this._events = objectCreate(null);\n                else delete events[type];\n            }\n            return this;\n        }\n\n        // emit off for all listeners on all events\n        if (arguments.length === 0) {\n            var keys = objectKeys(events);\n            var key;\n            for (i = 0; i < keys.length; ++i) {\n                key = keys[i];\n                if (key === 'off') continue;\n                this.removeAllListeners(key);\n            }\n            this.removeAllListeners('off');\n            this._events = objectCreate(null);\n            this._eventsCount = 0;\n            return this;\n        }\n\n        listeners = events[type];\n\n        if (typeof listeners === 'function') {\n            this.off(type, listeners);\n        } else if (listeners) {\n            // LIFO order\n            for (i = listeners.length - 1; i >= 0; i--) {\n                this.off(type, listeners[i]);\n            }\n        }\n\n        return this;\n    }\n\n    listeners(type) {\n        return _listeners(this, type, true);\n    }\n\n    rawListeners(type) {\n        return _listeners(this, type, false);\n    }\n\n    listenerCount() {\n        return EventEmitter.listenerCount.apply(this, arguments);\n    }\n}\n\nlet hasDefineProperty;\ntry {\n    var o = {};\n    if (Object.defineProperty) Object.defineProperty(o, 'x', { value: 0 });\n    hasDefineProperty = o['x'] === 0;\n} catch (err) {\n    hasDefineProperty = false;\n}\nif (hasDefineProperty) {\n    Object.defineProperty(EventEmitter, 'defaultMaxListeners', {\n        enumerable: true,\n        get: function () {\n            return defaultMaxListeners;\n        },\n        set: function (arg) {\n            // check whether the input is a positive number (whose value is zero or\n            // greater and not a NaN).\n            if (typeof arg !== 'number' || arg < 0 || arg !== arg)\n                throw new TypeError('\"defaultMaxListeners\" must be a positive number');\n            defaultMaxListeners = arg;\n        }\n    });\n} else {\n    EventEmitter.defaultMaxListeners = defaultMaxListeners;\n}\n\nfunction $getMaxListeners(that) {\n    if (that._maxListeners === undefined) return EventEmitter.defaultMaxListeners;\n    return that._maxListeners;\n}\n\n// These standalone emit* functions are used to optimize calling of event\n// handlers for fast cases because emit() itself often has a variable number of\n// arguments and can be deoptimized because of that. These functions always have\n// the same number of arguments and thus do not get deoptimized, so the code\n// inside them can execute faster.\nfunction emitNone(handler, isFn, self) {\n    if (isFn) handler.call(self);\n    else {\n        var len = handler.length;\n        var listeners = arrayClone(handler, len);\n        for (var i = 0; i < len; ++i) {\n            try {\n                listeners[i].call(self);\n            } catch (e) {\n                console.error(e);\n            }\n        }\n    }\n}\n\nfunction emitOne(handler, isFn, self, arg1) {\n    if (isFn) handler.call(self, arg1);\n    else {\n        var len = handler.length;\n        var listeners = arrayClone(handler, len);\n        for (var i = 0; i < len; ++i) {\n            try {\n                listeners[i].call(self, arg1);\n            } catch (e) {\n                console.error(e);\n            }\n        }\n    }\n}\n\nfunction emitTwo(handler, isFn, self, arg1, arg2) {\n    if (isFn) handler.call(self, arg1, arg2);\n    else {\n        var len = handler.length;\n        var listeners = arrayClone(handler, len);\n        for (var i = 0; i < len; ++i) {\n            try {\n                listeners[i].call(self, arg1, arg2);\n            } catch (e) {\n                console.error(e);\n            }\n        }\n    }\n}\n\nfunction emitThree(handler, isFn, self, arg1, arg2, arg3) {\n    if (isFn) handler.call(self, arg1, arg2, arg3);\n    else {\n        var len = handler.length;\n        var listeners = arrayClone(handler, len);\n        for (var i = 0; i < len; ++i) {\n            try {\n                listeners[i].call(self, arg1, arg2, arg3);\n            } catch (e) {\n                console.error(e);\n            }\n        }\n    }\n}\n\nfunction emitMany(handler, isFn, self, args) {\n    if (isFn) handler.apply(self, args);\n    else {\n        var len = handler.length;\n        var listeners = arrayClone(handler, len);\n        for (var i = 0; i < len; ++i) {\n            try {\n                listeners[i].apply(self, args);\n            } catch (e) {\n                console.error(e);\n            }\n        }\n    }\n}\n\nfunction _addListener(target: EventEmitter, type, listener: Function) {\n    var m;\n    var events;\n    var existing;\n\n    if (typeof listener !== 'function') throw new TypeError('\"listener\" argument must be a function');\n\n    events = target._events;\n    if (!events) {\n        events = target._events = objectCreate(null);\n        target._eventsCount = 0;\n    } else {\n        // To avoid recursion in the case that type === \"newListener\"! Before\n        // adding it to the listeners, first emit \"newListener\".\n        if (events.newListener) {\n            target.emit('newListener', type, listener['listener'] ? listener['listener'] : listener);\n\n            // Re-assign `events` because a newListener handler could have caused the\n            // this._events to be assigned to a new object\n            events = target._events;\n        }\n        existing = events[type];\n    }\n\n    if (!existing) {\n        // Optimize the case of one listener. Don't need the extra array object.\n        existing = events[type] = listener;\n        ++target._eventsCount;\n    } else {\n        if (typeof existing === 'function') {\n            // Adding the second element, need to change to array.\n            existing = events[type] = [existing, listener];\n        } else {\n            existing.push(listener);\n        }\n\n        // Check for listener leak\n        if (!existing.warned) {\n            m = $getMaxListeners(target);\n            if (m && m > 0 && existing.length > m) {\n                existing.warned = true;\n\n                class CustomError extends Error {\n                    emitter: any;\n                    type: string;\n                    count: number;\n                }\n                let w: CustomError = new CustomError(\n                    'Possible Dispatcher memory leak detected. ' +\n                        existing.length +\n                        ' \"' +\n                        String(type) +\n                        '\" listeners ' +\n                        'added. Use emitter.setMaxListeners() to ' +\n                        'increase limit.'\n                );\n                w.name = 'MaxListenersExceededWarning';\n                w.emitter = target;\n                w.type = type;\n                w.count = existing.length;\n\n                if (typeof console === 'object' && console.warn) {\n                    console.warn('%s: %s', w.name, w.message);\n                }\n            }\n        }\n    }\n\n    return target;\n}\n\nfunction _removeListener(type, listener) {\n    var list, events, position, i, originalListener;\n\n    if (typeof listener !== 'function') throw new TypeError('\"listener\" argument must be a function');\n\n    events = this._events;\n    if (!events) return this;\n\n    list = events[type];\n    if (!list) return this;\n\n    if (list === listener || list.listener === listener) {\n        if (--this._eventsCount === 0) this._events = objectCreate(null);\n        else {\n            delete events[type];\n            if (events.off) this.emit('off', type, list.listener || listener);\n        }\n    } else if (typeof list !== 'function') {\n        position = -1;\n\n        for (i = list.length - 1; i >= 0; i--) {\n            if (list[i] === listener || list[i].listener === listener) {\n                originalListener = list[i].listener;\n                position = i;\n                break;\n            }\n        }\n\n        if (position < 0) return this;\n\n        if (position === 0) list.shift();\n        else spliceOne(list, position);\n\n        if (list.length === 1) events[type] = list[0];\n\n        if (events.off) this.emit('off', type, originalListener || listener);\n    }\n\n    return this;\n}\n\nfunction onceWrapper() {\n    if (!this.fired) {\n        this.target.off(this.type, this.wrapFn);\n        this.fired = true;\n        switch (arguments.length) {\n            case 0:\n                return this.listener.call(this.target);\n            case 1:\n                return this.listener.call(this.target, arguments[0]);\n            case 2:\n                return this.listener.call(this.target, arguments[0], arguments[1]);\n            case 3:\n                return this.listener.call(this.target, arguments[0], arguments[1], arguments[2]);\n            default:\n                var args = new Array(arguments.length);\n                for (var i = 0; i < args.length; ++i) args[i] = arguments[i];\n                this.listener.apply(this.target, args);\n        }\n    }\n}\n\nfunction _onceWrap(target, type, listener) {\n    var state = { fired: false, wrapFn: undefined, target: target, type: type, listener: listener };\n    var wrapped = bind.call(onceWrapper, state);\n    wrapped.listener = listener;\n    state.wrapFn = wrapped;\n    return wrapped;\n}\n\nfunction _listeners(target, type, unwrap) {\n    var events = target._events;\n\n    if (!events) return [];\n\n    var evlistener = events[type];\n    if (!evlistener) return [];\n\n    if (typeof evlistener === 'function') return unwrap ? [evlistener.listener || evlistener] : [evlistener];\n\n    return unwrap ? unwrapListeners(evlistener) : arrayClone(evlistener, evlistener.length);\n}\n\nfunction listenerCount(type) {\n    var events = this._events;\n\n    if (events) {\n        var evlistener = events[type];\n\n        if (typeof evlistener === 'function') {\n            return 1;\n        } else if (evlistener) {\n            return evlistener.length;\n        }\n    }\n\n    return 0;\n}\n\n// About 1.5x faster than the two-arg version of Array#splice().\nfunction spliceOne(list, index) {\n    for (var i = index, k = i + 1, n = list.length; k < n; i += 1, k += 1) list[i] = list[k];\n    list.pop();\n}\n\nfunction arrayClone(arr, n) {\n    var copy = new Array(n);\n    for (var i = 0; i < n; ++i) copy[i] = arr[i];\n    return copy;\n}\n\nfunction unwrapListeners(arr) {\n    var ret = new Array(arr.length);\n    for (var i = 0; i < ret.length; ++i) {\n        ret[i] = arr[i].listener || arr[i];\n    }\n    return ret;\n}\n\nfunction objectCreatePolyfill(proto) {\n    var F = function () {};\n    F.prototype = proto;\n    return new F();\n}\n\nfunction objectKeysPolyfill(obj) {\n    var keys = [];\n    for (var k in obj)\n        if (Object.prototype.hasOwnProperty.call(obj, k)) {\n            keys.push(k);\n        }\n    return k;\n}\n\nfunction functionBindPolyfill(context) {\n    var fn = this;\n    return function () {\n        return fn.apply(context, arguments);\n    };\n}\n","import EventEmitter from '../util/event-emitter';\n\nexport class Context extends EventEmitter {}\n\nexport type PushConf = Partial<{\n    done: boolean;\n    stubTime: number;\n    offsetPos: number; // Represents the start byte of the pushed data relative to the entire file\n}>;\n\nexport type GlobalOptions = Partial<{\n    debug: boolean;\n    decodeCodec: boolean;\n    config: PushConf;\n}>;\n\nexport interface IDemux {\n    /**\n     * Pipe the arrayBuffer to the demuxer.\n     * @param buf\n     * @param conf\n     */\n    push(buf: ArrayBuffer | Uint8Array, conf: PushConf): void;\n\n    reset(): void;\n\n    destroy(): void;\n}\n","/**\n * @file: is.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = Object.prototype.toString;\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nexport function isObjectLike(value: any): boolean {\n    return !!value && typeof value == 'object';\n}\n\nexport function isEmptyObject(obj: object): boolean {\n    for (var prop in obj) {\n        if (Object.prototype.hasOwnProperty.call(obj, prop)) {\n            return false;\n        }\n    }\n    return JSON.stringify(obj) === JSON.stringify({});\n}\n\n/**\n * @param url\n */\nexport function isHttps(url?: string): boolean {\n    return /^https/gi.test(url || window.location.protocol);\n}\n\n/**\n * @param num\n */\nexport function isNumber(num: any): boolean {\n    return typeof num === 'number' && !isNaN(num);\n}\n\n/**\n * @param value\n */\nexport function isArrayBuffer(value: any): boolean {\n    return isObjectLike(value) && objectToString.call(value).toLowerCase() === '[object arraybuffer]';\n}\n\n/**\n * @param value\n */\nexport function isUint8Array(value: any): boolean {\n    return isObjectLike(value) && objectToString.call(value).toLowerCase() === '[object uint8array]';\n}\n","/**\n * @file: cache-buffer.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport { isNumber } from './is';\n\n/**\n * Cache Buffer util.\n * It's applicable for streaming data cutting and retaining the data,\n * the algorithm minimizes memory application as much as possible.\n */\n\nexport default class CacheBuffer {\n    get byteLength(): number {\n        if (!isNumber(this.byteLength_)) {\n            let len = 0;\n\n            for (let i = 0, item: Uint8Array; i < this.list_.length; i++) {\n                item = this.list_[i];\n                len += item.byteLength;\n            }\n            this.byteLength_ = len;\n        }\n\n        return this.byteLength_;\n    }\n\n    /**\n     * maybe return new allocated memory or original memory\n     */\n    get bytes(): Uint8Array | null {\n        const { bufferList } = this;\n        let bytes = null;\n\n        if (bufferList.length > 0) {\n            if (bufferList.length === 0) {\n                bytes = bufferList[0];\n            } else {\n                bytes = this.toNewBytes();\n            }\n        }\n\n        return bytes;\n    }\n\n    get empty() {\n        return this.list_.length === 0;\n    }\n\n    get bufferList() {\n        return this.list_;\n    }\n\n    /**\n     * Used to cache calculations, reduce the number of CPU calculations.\n     * When internal data changes, the value needs to be cleared and recalculated.\n     */\n    private byteLength_: number | null;\n\n    private list_: Array<Uint8Array> = [];\n\n    clear() {\n        let len = this.list_.length;\n        if (len > 0) {\n            this.list_.splice(0, len);\n        }\n        this.byteLength_ = null;\n    }\n\n    toNewBytes(): Uint8Array | null {\n        let bytes = null;\n        let tryCount: number = 0;\n        let maxTryCount: number = 50;\n\n        // The following retry strategies are provided for failed memory applications\n        // In terms of a better strategy, a failed memory application retry should be\n        // an asynchronous process, which does not return until the application succeeds.\n        // But the original design of the library is synchronous.\n        while (bytes === null) {\n            try {\n                tryCount++;\n                bytes = new Uint8Array(this.byteLength);\n            } catch (e) {\n                if (tryCount > maxTryCount) {\n                    throw e;\n                }\n            }\n        }\n\n        for (let i = 0, offset = 0; i < this.list_.length; i++) {\n            let payload = this.list_[i];\n\n            bytes.set(payload, offset);\n            offset += payload.byteLength;\n        }\n\n        return bytes;\n    }\n\n    append(newBuffer: Uint8Array | CacheBuffer): void {\n        if (newBuffer instanceof CacheBuffer) {\n            this.list_ = this.list_.concat(newBuffer.bufferList);\n        } else {\n            this.list_.push(newBuffer);\n        }\n\n        this.byteLength_ = null;\n    }\n\n    /**\n     * This function cuts a complete TypedArray from CacheBuffer and retains the remainder of CacheBuffer.\n     * The following points should be noted when using this function:\n     * 1. If the cut needs to return the cut-out part, the cut length should be as small as possible to reduce the errors in memory application.\n     * 2. If the cutting is only to preserve the remaining parts, the cutting size is within the total number of bytes, without considering memory applications.\n     * @param {number} fixedLength\n     * @param {boolean} [needCutResult] - If not, just retain the remaining parts after cutting.\n     */\n    cut(fixedLength: number, needCutResult: boolean = true): Uint8Array {\n        let chunk = null;\n\n        if (fixedLength > 0 && !this.empty) {\n            let list = this.list_;\n\n            let offset = 0;\n            let loopIndex = 0;\n\n            while (list.length > 0) {\n                let cur = list.shift();\n\n                if (loopIndex === 0) {\n                    if (cur.byteLength >= fixedLength) {\n                        if (needCutResult) {\n                            // Here is the key point for optimize memory alloc\n                            chunk = cur.subarray(0, fixedLength);\n                        }\n\n                        if (cur.byteLength > fixedLength) {\n                            cur = cur.subarray(fixedLength);\n                            list.unshift(cur);\n                        }\n                        break;\n                    } else {\n                        if (needCutResult) {\n                            try {\n                                chunk = new Uint8Array(fixedLength);\n                            } catch (e) {\n                                throw `alloc_memory_error@ cache buffer: ${fixedLength} ${e.message}`;\n                            }\n\n                            chunk.set(cur, 0);\n                        }\n                        offset += cur.byteLength;\n                    }\n                } else {\n                    let subLen = fixedLength - offset;\n\n                    if (cur.byteLength >= subLen) {\n                        if (needCutResult) {\n                            chunk.set(cur.subarray(0, subLen), offset);\n                        }\n\n                        cur = cur.subarray(subLen);\n\n                        if (cur.byteLength > 0) {\n                            list.unshift(cur);\n                        }\n\n                        break;\n                    } else {\n                        if (needCutResult) {\n                            chunk.set(cur, offset);\n                        }\n                        offset += cur.byteLength;\n                        break;\n                    }\n                }\n\n                loopIndex++;\n            }\n\n            this.byteLength_ = null;\n        }\n\n        return chunk;\n    }\n}\n","/**\n * @fileOverview A simple multimap template.\n */\n\ninterface MapData {\n    [index: string]: Array<any>;\n}\n\nexport default class MultiMap {\n    private map_: MapData;\n\n    constructor() {\n        this.map_ = {};\n    }\n\n    /**\n     * Add a key, value pair to the map.\n     * @param key\n     * @param value\n     */\n    push(key: string, value: any) {\n        if (Object.prototype.hasOwnProperty.call(this.map_, key)) {\n            this.map_[key].push(value);\n        } else {\n            this.map_[key] = [value];\n        }\n    }\n\n    /**\n     * Get a list of values by key.\n     * @param key\n     */\n    get(key: string): Array<any> {\n        let list = this.map_[key];\n        // slice() clones the list so that it and the map can each be modified\n        // without affecting the other.\n        return list ? list.slice() : null;\n    }\n\n    /**\n     * Get a list of all values.\n     */\n    getAll(): Array<any> {\n        let list = [];\n        for (let key in this.map_) {\n            list.push.apply(list, this.map_[key]);\n        }\n        return list;\n    }\n\n    /**\n     * Remove a specific value, if it exists.\n     * @param key\n     * @param value\n     */\n    remove(key: string, value: any): void {\n        let list = this.map_[key];\n        if (list) {\n            for (let i = 0; i < list.length; ++i) {\n                if (list[i] == value) {\n                    list.splice(i, 1);\n                    --i;\n                }\n            }\n        }\n    }\n\n    /**\n     * Clear all keys and values from the multimap.\n     */\n    clear(): void {\n        this.map_ = {};\n    }\n\n    /**\n     * @param callback\n     */\n    forEach(callback: Function): void {\n        for (let key in this.map_) {\n            callback(key, this.map_[key]);\n        }\n    }\n}\n","import MultiMap from './multi-map';\n\n/**\n * Creates a new Binding_ and attaches the event listener to the event target.\n */\nclass Binding_ {\n    target: any;\n    type: string;\n    listener: Function;\n\n    /**\n     * @param target - The event target.\n     * @param type - The event type.\n     * @param listener - The event listener.\n     */\n    constructor(target: any, type: string, listener: Function) {\n        this.target = target;\n        this.type = type;\n        this.listener = listener;\n\n        if (this.target.addEventListener) {\n            this.target.addEventListener(type, listener, false);\n        } else if (this.target.on) {\n            this.target.on(type, listener, false);\n        }\n    }\n\n    /**\n     * Detaches the event listener from the event target.\n     * This does nothing if the event listener is already detached.\n     */\n    off() {\n        if (this.target.removeEventListener) {\n            this.target.removeEventListener(this.type, this.listener, false);\n        } else if (this.target.off) {\n            this.target.off(this.type, this.listener, false);\n        }\n\n        this.target = null;\n        this.listener = null;\n    }\n}\n\n/**\n * Creates a new EventManager.\n * An EventManager maintains a collection of \"event bindings\" between event targets and event listeners.\n */\nexport default class EventManager {\n    private bindingMap_: MultiMap;\n    // static Binding_: Binding;\n\n    constructor() {\n        /**\n         * Maps an event type to an array of event bindings.\n         */\n        this.bindingMap_ = new MultiMap();\n    }\n\n    /**\n     * Detaches all event listeners.\n     * @override\n     */\n    destroy(): void {\n        this.removeAll();\n        this.bindingMap_ = null;\n    }\n\n    /**\n     * Attaches an event listener to an event target.\n     * @param target - The event target.\n     * @param type  - The event type.\n     * @param listener  - The event listener.\n     */\n    on(target: any, type: string, listener: Function): EventManager {\n        if (!this.bindingMap_) return;\n\n        let binding = new Binding_(target, type, listener);\n        this.bindingMap_.push(type, binding);\n\n        return this;\n    }\n\n    /**\n     * Attaches an event listener to an event target.\n     * The listener will be removed when the first instance of the event is fired.\n     * @param {EventTarget} target The event target.\n     * @param {string} type The event type.\n     * @param {function} listener The event listener.\n     */\n    once(target: any, type: string, listener: Function) {\n        // Install a shim listener that will stop listening after the first event.\n        this.on(\n            target,\n            type,\n            function (event: any) {\n                // Stop listening to this event.\n                this.off(target, type);\n                // Call the original listener.\n                listener(event);\n            }.bind(this)\n        );\n    }\n\n    /**\n     * Detaches an event listener from an event target.\n     * @param {EventTarget} target The event target.\n     * @param {string} type The event type.\n     */\n    off(target: any, type: string): void {\n        if (!this.bindingMap_) return;\n\n        let list = this.bindingMap_.get(type) || [];\n\n        for (let i = 0; i < list.length; ++i) {\n            let binding = list[i];\n\n            if (binding.target == target) {\n                binding.off();\n                this.bindingMap_.remove(type, binding);\n            }\n        }\n    }\n\n    /**\n     * Detaches all event listeners from all targets.\n     */\n    removeAll(): void {\n        if (!this.bindingMap_) return;\n\n        let list = this.bindingMap_.getAll();\n\n        for (let i = 0; i < list.length; ++i) {\n            list[i].off();\n        }\n\n        this.bindingMap_.clear();\n    }\n}\n\n// EventManager.Binding_ = Binding;\n","/**\n * @file: global.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * @description provide global scope.\n */\nlet global: any;\n\n// see https://stackoverflow.com/a/11237259/589493\nif (typeof window === 'undefined') {\n    /* eslint-disable-next-line no-undef */\n    global = self;\n} else {\n    global = window;\n}\n\nexport default global;\n","/**\n * @file: logger.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * utils - logger\n */\n/* global WorkerGlobalScope */\nimport global from './global';\nimport EventEmitter from './event-emitter';\n\nlet console = global.console;\nconst isWorker =\n    typeof WorkerGlobalScope !== 'undefined' &&\n    self instanceof WorkerGlobalScope &&\n    typeof importScripts != 'undefined';\nconst prefix = '>>>';\n\nclass Logger extends EventEmitter {\n    private MSG_NAME: string;\n    private _enable: boolean;\n\n    get enable() {\n        return this._enable;\n    }\n\n    set enable(value: boolean) {\n        this._enable = value;\n\n        this.MSG_NAME = '__log__';\n    }\n\n    constructor() {\n        super();\n        this._enable = false;\n    }\n\n    log(...restArgs: any) {\n        if (isWorker) {\n            logger.emit(this.MSG_NAME, 'log', [...restArgs].join(''));\n        } else {\n            if (this._enable) {\n                console.log.call(console, prefix, ...restArgs);\n            }\n        }\n    }\n\n    debug(...restArgs: any) {\n        if (isWorker) {\n            logger.emit(this.MSG_NAME, 'debug', [...restArgs].join(''));\n        } else {\n            if (this._enable && console.debug) {\n                console.debug.call(console, prefix, ...restArgs);\n            }\n        }\n    }\n\n    assert(...restArgs: any) {\n        if (this._enable && console.assert) {\n            let condition = restArgs[0];\n            let sliceArgs = Array.prototype.slice.call(restArgs, 1);\n            sliceArgs.unshift(prefix);\n\n            console.assert.call(console, condition, ...sliceArgs);\n        }\n    }\n\n    warn(...restArgs: any) {\n        if (isWorker) {\n            logger.emit(this.MSG_NAME, 'warn', [...restArgs].join(''));\n        } else {\n            if (this._enable) {\n                console.warn.call(console, prefix, ...restArgs);\n            }\n        }\n    }\n\n    error(...restArgs: any) {\n        if (isWorker) {\n            logger.emit(this.MSG_NAME, 'error', [...restArgs].join(''));\n        } else {\n            if (this._enable) {\n                console.error.call(console, prefix, ...restArgs);\n            }\n        }\n    }\n}\n\nlet logger = new Logger();\n\n/**\n * @param {Object} obj - custom logger\n */\nexport function setLogger(obj) {\n    console = obj;\n}\n\nexport function getLogger() {\n    return logger;\n}\n\nexport default logger;\n","/**\n * @file: stream.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * simple stream implementation.\n */\n\nimport { PushConf } from '../types/globals';\nimport EventEmitter from './event-emitter';\n\nclass Stream extends EventEmitter {\n    constructor() {\n        super();\n    }\n\n    /**\n     * connect to the next pipeline stream.\n     * @param destination\n     */\n    pipe(destination: Stream): Stream {\n        this.on('reset', function () {\n            destination.reset();\n        });\n\n        this.on('data', function (data) {\n            destination.push(data);\n        });\n\n        this.on('done', function (flushSource) {\n            destination.flush(flushSource);\n        });\n\n        return destination;\n    }\n\n    /**\n     * detaches the next pipeline stream previously attached.\n     */\n    unpipe(): Stream {\n        this.removeAllListeners('reset');\n        this.removeAllListeners('data');\n        this.removeAllListeners('done');\n\n        return this;\n    }\n\n    /**\n     * push data to current pipeline.\n     * @param data\n     */\n    push(data: any, conf?: PushConf): void {\n        if (conf) {\n        }\n        this.emit('data', data);\n    }\n\n    /**\n     * flush current pipeline.\n     * @param flushSource\n     */\n    flush(flushSource: Stream): void {\n        this.emit('done', flushSource);\n    }\n\n    reset(): void {\n        this.emit('reset');\n    }\n}\n\nexport default Stream;\n","/**\n * @file: demuxer.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\nimport { Events } from './enum/events';\nimport { Context, GlobalOptions, IDemux, PushConf } from './types/globals';\nimport CacheBuffer from './util/cache-buffer';\nimport EventManager from './util/event-manager';\nimport { isArrayBuffer, isUint8Array } from './util/is';\nimport logger from './util/logger';\nimport Stream from './util/stream';\n\nexport default abstract class DemuxFacade extends Stream implements IDemux {\n    readonly endStream?: Stream;\n    protected eventManager_: EventManager;\n    protected ctx_: Context;\n    protected options_: GlobalOptions;\n    protected cache_buffer_: CacheBuffer;\n\n    protected listenEndStream_(): void {\n        this.eventManager_ = new EventManager();\n\n        this.eventManager_\n            .on(this.endStream, 'data', (data) => {\n                this.emit(Events.DEMUX_DATA, data);\n            })\n            .on(this.endStream, 'done', (data) => {\n                this.emit(Events.DONE, data);\n            })\n            .on(this.ctx_, 'error', (data) => {\n                this.emit(Events.ERROR, data);\n            });\n    }\n\n    constructor(options: GlobalOptions = {}) {\n        super();\n\n        if (options.debug) {\n            logger.enable = true;\n        }\n\n        this.ctx_ = new Context();\n        this.options_ = options;\n        this.cache_buffer_ = new CacheBuffer();\n    }\n\n    /**\n     * Pipe the arrayBuffer to the demuxer.\n     * @param buf\n     * @param conf\n     */\n    abstract push(buf: ArrayBuffer | Uint8Array, conf: PushConf): void;\n\n    /**\n     * transfer data to Uint8Array\n     * @param buf\n     */\n    protected constraintPushData_(buf: ArrayBuffer | Uint8Array): Uint8Array | null {\n        let newBuf = null;\n        if (!isArrayBuffer(buf) && !isUint8Array(buf)) {\n            logger.error(`Data pushed is not an ArrayBuffer or Uint8Array: ${buf}`);\n            return newBuf;\n        }\n\n        if (isArrayBuffer(buf)) {\n            newBuf = new Uint8Array(buf);\n        } else {\n            newBuf = buf;\n        }\n\n        return newBuf;\n    }\n\n    reset(): void {}\n\n    destroy(): void {\n        this.unpipe();\n        this.endStream.unpipe();\n\n        this.eventManager_.removeAll();\n    }\n}\n","/**\n * @file: mux-error-code.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * @readonly\n * @enum {Number}\n */\nenum codes {\n    WORKER_EXCEPTION = 0,\n    WORKER_MSG_EXCEPTION,\n    TS_SYNC_BYTE,\n    FLV_HEAD_SIGNATURE,\n    FLV_NOT_EXPECTED_ADJACENT_DATA\n}\n\nexport default codes;\n","/**\n * @file: patSection.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport logger from '../../util/logger';\n\n/**\n * Structure for pat.\n */\nexport class PATSection {\n    // table_id: number;\n    // section_syntax_indicator: number;\n    // section_length: number;\n    // transport_stream_id: number;\n    // version_number: number;\n    // current_next_indicator: number;\n    // section_number: number;\n    // last_section_number: number;\n    // network_PID: number;\n    pmtTable: Array<M2TS.PMTTableItem>;\n    // CRC_32: number;\n\n    constructor(buffer: Uint8Array) {\n        // program_association_section 0x00\n        // this.table_id = buffer[0];\n\n        // this.section_syntax_indicator = buffer[1] >> 7;\n\n        // this.zero = (buffer[1] >> 6) & 0x1;\n\n        // this.reserved_0 = (buffer[1] >> 4) & 0x3;\n\n        // the number of bytes of the section\n        // starting immediately following the section_length field, and including the CRC.\n        let section_length = ((buffer[1] & 0x0f) << 8) | buffer[2];\n\n        // this.transport_stream_id = (buffer[3] << 8) | buffer[4];\n\n        // this.reserved_1 = buffer[5] >> 6;\n\n        // this.version_number = (buffer[5] >> 1) & 0x1f;\n\n        // this.current_next_indicator = buffer[5] && 0x01;\n\n        // The section_number of the first section in the Program Association Table shall be 0x00.\n        // It shall be incremented by 1 with each additional section in the PAT.\n        // this.section_number = buffer[6];\n\n        // The number of the last section (that is, the section with the highest section_number) of the complete PAT.\n        // this.last_section_number = buffer[7];\n\n        // this.network_PID = 0x00;\n\n        var n = 0,\n            program_num;\n        // reserved_3;\n        var len = section_length - 4 - 5; // 4: crc32, 5: bytes followed by section_length\n\n        this.pmtTable = [];\n        /* loop by 4 bytes, during  */\n        for (; n < len; n += 4) {\n            program_num = (buffer[n + 8] << 8) | buffer[n + 9];\n            // reserved_3 = buffer[10 + n] >> 5;\n\n            if (program_num == 0x00) {\n                let network_PID = ((buffer[10 + n] & 0x1f) << 8) | buffer[11 + n];\n\n                // 记录该TS流的网络PID\n                // TS_network_Pid = this.network_PID;\n\n                logger.log('packet->network_PID %0x /n/n', network_PID);\n            } else {\n                this.pmtTable.push({\n                    programNum: program_num,\n                    program_map_PID: ((buffer[10 + n] & 0x1f) << 8) | buffer[11 + n]\n                });\n\n                // TS_PAT_Program\n                // PAT_program;\n                // PAT_program.program_map_PID = (buffer[10 + n] & 0x1F) << 8 | buffer[11 + n];\n                // PAT_program.program_number = program_num;\n                // this.program.push_back(PAT_program);\n                // TS_program.push_back(PAT_program);//向全局PAT节目数组中添加PAT节目信息\n            }\n        }\n\n        // var crcLength = this.section_length + 3;\n        // this.CRC_32 =\n        //     ((buffer[crcLength - 4] & 0x000000ff) << 24) |\n        //     ((buffer[crcLength - 3] & 0x000000ff) << 16) |\n        //     ((buffer[crcLength - 2] & 0x000000ff) << 8) |\n        //     (buffer[crcLength - 1] & 0x000000ff);\n    }\n}\n","/**\n * @file: pmtSection.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Structure for pat.\n */\nimport logger from '../../util/logger';\n\n/**\n * Structure for PMT.\n */\nexport class PMTSection {\n    // table_id: number;\n    // section_syntax_indicator: number;\n    // section_length: number;\n    // program_number: number;\n    // version_number: number;\n    // current_next_indicator: number;\n    // section_number: number;\n    // last_section_number: number;\n    // PCR_PID: number;\n    pes_table: Array<M2TS.PESTableItem>;\n    // CRC_32: number;\n\n    constructor(buffer: Uint8Array) {\n        // program_map_section  0x02\n        // this.table_id = buffer[0];\n\n        // this.section_syntax_indicator = buffer[1] >> 7;\n\n        // this.zero = (buffer[1] >> 6) & 0x1;\n\n        // this.reserved_0 = (buffer[1] >> 4) & 0x3;\n\n        // the number of bytes of the section\n        // starting immediately following the section_length field, and including the CRC.\n        let section_length = ((buffer[1] & 0x0f) << 8) | buffer[2];\n\n        // It specifies the program to which the program_map_PID is applicable.\n        // this.program_number = (buffer[3] << 8) | buffer[4];\n\n        // this.reserved_1 = buffer[5] >> 6;\n\n        // this.version_number = (buffer[5] >> 1) & 0x1f;\n\n        // this.current_next_indicator = buffer[5] && 0x01;\n\n        // The section_number of the first section in the Program Association Table shall be 0x00.\n        // It shall be incremented by 1 with each additional section in the PAT.\n        // this.section_number = buffer[6];\n\n        // The number of the last section (that is, the section with the highest section_number) of the complete PAT.\n        // this.last_section_number = buffer[7];\n\n        // contain the PCR fields valid for the program specified by program_number.\n        // this.PCR_PID = ((buffer[8] & 0x1f) << 8) | buffer[9];\n\n        // this.reserved_2 = buffer[10] >> 4;\n\n        // The number of bytes of the descriptors immediately following the program_info_length field.\n        const program_info_length = ((buffer[10] & 0x0f) << 8) | buffer[11];\n\n        if (program_info_length < 0) {\n            return;\n        } else if (program_info_length > 2) {\n            let i = 0;\n\n            while (i < program_info_length) {\n                // let descriptor_tag = buffer[12 + i];\n                let descriptor_length = buffer[13 + i];\n\n                // \tlogger.log('descriptor_tag', descriptor_tag, descriptor_length);\n                i += descriptor_length;\n            }\n        }\n\n        var es_section_pos = 12 + program_info_length;\n        var es_section_len = section_length - program_info_length - 9 - 4; // 9: bytes followed by section_length, 4: crc32\n        var es_section_end = es_section_pos + es_section_len;\n\n        if (es_section_pos >= es_section_end) {\n            logger.warn(`es_section_pos < es_section_end ${es_section_pos}, ${es_section_end}`);\n            return;\n        }\n\n        this.pes_table = [];\n\n        let j = 0;\n        while (j < es_section_len) {\n            let basePos = es_section_pos + j;\n            let stream_type = buffer[basePos];\n            let elementary_PID = ((buffer[basePos + 1] << 8) | buffer[basePos + 2]) & 0x1fff;\n            let ES_info_length = ((buffer[basePos + 3] << 8) | buffer[basePos + 4]) & 0x0fff;\n\n            this.pes_table.push({\n                streamType: stream_type,\n                PID: elementary_PID\n            });\n\n            // if (ES_info_length > 2) {\n            //     let k = 0;\n            //     let es_pos = basePos + 5;\n\n            //     while (k < ES_info_length) {\n            //         // let descriptor_tag = buffer[es_pos + k];\n            //         let descriptor_length = buffer[es_pos + k];\n\n            //         // if (descriptor_tag === )\n            //         k += descriptor_length;\n            //     }\n            // }\n\n            j += ES_info_length + 5;\n        }\n\n        // var crcLength = this.section_length + 3;\n        // this.CRC_32 =\n        //     ((buffer[crcLength - 4] & 0x000000ff) << 24) |\n        //     ((buffer[crcLength - 3] & 0x000000ff) << 16) |\n        //     ((buffer[crcLength - 2] & 0x000000ff) << 8) |\n        //     (buffer[crcLength - 1] & 0x000000ff);\n    }\n}\n","/**\n * @file: m2t-pid.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * @overview Program and program element descriptors.\n * @see ISO/IEC 13818-1: Table 2-3 – PID table\n * @see DVB SI: 5.1.3 Coding of PID and table_id fields\n */\n\n/**\n * @readonly\n * @enum {number}\n * @export\n */\nexport const PAT_PID = 0x0000;\nexport const CAT_PID = 0x0001;\nexport const TSDT_PID = 0x0002;\n/* reserved 0x0003 to 0x000F */\nexport const SDT_PID = 0x0011;\n","/**\n * @file: psi.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * PSI(Program Specific Information)\n */\n// import { HevcPPSProps, HevcSPSProps, HevcVPSProps } from '../codec/avc';\nimport { PATSection } from './structs/patSection';\nimport { PMTSection } from './structs/pmtSection';\n// import { SDTSection } from './structs/sdtSection';\nimport { PAT_PID, CAT_PID, TSDT_PID, SDT_PID } from '../enum/m2t-pid';\n// import { Context } from '../types/globals';\nimport { Packet } from './structs/packet';\n// import StreamTypes from '../enum/stream-types';\nimport { StreamTypes } from '../enum/stream-types';\nimport { GOPVector, AACFrameVector } from './types/pipeline';\n\n// const MAX_PIDS_PER_PROGRAM = 64;\n\ntype TrackType = 'video' | 'audio' | 'caption';\n\nexport interface Track {\n    id: number;\n    type: TrackType;\n    stream_type: StreamTypes;\n    duration: number;\n    width?: number;\n    height?: number;\n    codec: string;\n    realCodec?: string;\n    firstDTS: number;\n    firstPTS: number;\n\n    // Video\n    gops: GOPVector;\n    profileIdc?: number;\n    profileCompatibility?: number;\n    levelIdc?: number;\n    pixelRatio?: [number, number];\n    timescale: number; // (in TS timescale = 90kHz)\n    inputTimeScale?: number;\n    sps: Array<Uint8Array>;\n    pps: Array<Uint8Array>;\n    vps: Array<Uint8Array>;\n    // hevc_vps: HevcVPSProps;\n    // hevc_sps: HevcSPSProps;\n    // hevc_pps: HevcPPSProps;\n\n    // Audio\n    isAAC?: boolean;\n    frames: AACFrameVector;\n    sampleRate?: number;\n    channelCount?: number;\n    config?: any;\n}\n\n// class Metadata {\n//     service_name: string;\n//     service_provider: string;\n// }\n\nexport class PSI {\n    constructor(ctx) {\n        // this.context = ctx;\n        // this.metadata = new Metadata();\n        this.pat_table = [];\n        this.pes_streams = [];\n    }\n\n    // private context: AVFormatContext;\n    // private metadata: Metadata; // Specify by SDT Packet\n    private pat_table: Array<M2TS.PATTableItem>; // Specify by PMT Packet\n    private pes_streams: Array<M2TS.PSI_PES_Stream>; // Specify by PES stream\n\n    /**\n     * program PID\n     */\n    get currentProgramPID(): number {\n        let _pmtIds = [];\n\n        for (let i = 0; i < this.pat_table.length; i++) {\n            _pmtIds.push(this.pat_table[i].pid);\n        }\n\n        return _pmtIds.length > 0 ? _pmtIds[0] : -1;\n    }\n\n    get tracks() {\n        return this.pes_streams;\n    }\n\n    // get pmtTable() {\n    //     return this.pat_table;\n    // }\n\n    /**\n     * 目前对于PSI的信息，持久化保留在内存中\n     * 对于同一个片子，HLS规范会规定只能有一个 PMT/PAT 表\n     * 所以一部片子的PSI信息应该是保持不变的，换片子后PSI信息的销毁通过 mux 重新实例化产生新的信息，不需要调用reset\n     * 有些 TS 文件在HLS切片器切割的时候，没有带上PAT/PMT等表，需要相邻 TS 给定的表信息\n     */\n    reset(): void {\n        // this.metadata = new Metadata();\n        this.pat_table.splice(0, this.pat_table.length);\n        this.pes_streams.splice(0, this.pes_streams.length);\n    }\n\n    /**\n     * @param packet\n     */\n    parse(packet: Packet): void {\n        const self = this;\n\n        // ISO13818-1: Table 2-3 – PID table\n        if (PAT_PID === packet.PID) {\n            /* PAT PID */\n            this._parsePat(packet);\n        } else if (CAT_PID === packet.PID) {\n            /* CAT PID */\n        } else if (TSDT_PID === packet.PID) {\n            /* Transport Stream Description Table */\n        } else if (0x0003 <= packet.PID && packet.PID <= 0x000f) {\n            /* Reserved */\n        } else if (SDT_PID === packet.PID) {\n            /* Service Description Table */\n            // this._parseSdt(packet);\n        } else if (packet.PID === self.currentProgramPID) {\n            /* PMT PID */\n            this._parsePmt(packet);\n        }\n        // else if (this.findTrack(packet.PID)) {\n        // \t/* Reserved */\n        // } else {\n        // \tlogger.warn(`psi unknown packet PID ${packet.PID}`);\n        // }\n    }\n\n    // findPmtProgram(PID) {\n    // \tlet program = null;\n    //\n    // \tfor (let i = 0; i < this.pat_table.length; i++) {\n    // \t\tif (this.pat_table[i].pid === PID) {\n    // \t\t\tprogram = this.pat_table[i].id;\n    // \t\t\tbreak;\n    // \t\t}\n    // \t}\n    //\n    // \treturn program;\n    // }\n\n    /**\n     * @param PID\n     */\n    findTrack(PID: number): Track {\n        let program = null;\n        let streams = this.pes_streams;\n\n        for (let i = 0; i < streams.length; i++) {\n            if (streams[i].id === PID) {\n                program = streams[i];\n                break;\n            }\n        }\n\n        return program;\n    }\n\n    /**\n     * Parse PAT Packet\n     * @param pack\n     */\n    private _parsePat(pack: Packet): PATSection {\n        let data: Uint8Array;\n\n        if (pack.payload_unit_start_indicator) {\n            // psi has pointer_field\n            let pointer = pack.payload[0];\n\n            data = pack.payload.subarray(pointer + 1);\n        } else {\n            data = pack.payload;\n        }\n\n        let pat = new PATSection(data);\n\n        // https://tools.ietf.org/html/rfc8216#section-3.2\n        // Transport Stream Segments MUST contain a single MPEG-2 Program;\n        for (var i = 0; i < pat.pmtTable.length; i++) {\n            this._add_pid_to_pmt(pat.pmtTable[i].programNum, pat.pmtTable[i].program_map_PID);\n        }\n\n        return pat;\n    }\n\n    /**\n     * Associates Program Number and Program Map Table(PMT) PID\n     * @param programId\n     * @param pid\n     */\n    private _add_pid_to_pmt(programId: number, pid: number): void {\n        let table = this.pat_table;\n\n        function get_pmt(id: number) {\n            for (let i = 0, item: M2TS.PATTableItem; i < table.length; i++) {\n                item = table[i];\n                if (item.id === id) {\n                    return {\n                        idx: i,\n                        item\n                    };\n                }\n            }\n            return null;\n        }\n\n        let p = get_pmt(programId);\n        if (!p) {\n            table.push({\n                id: programId,\n                pid: pid\n            });\n        }\n    }\n\n    /**\n     * Parse PMT Packet\n     * @param pack\n     */\n    private _parsePmt(pack: Packet): PMTSection {\n        let data: Uint8Array;\n\n        if (pack.payload_unit_start_indicator) {\n            // psi has pointer_field\n            let pointer = pack.payload[0];\n\n            data = pack.payload.subarray(pointer + 1);\n        } else {\n            data = pack.payload;\n        }\n\n        let pmt = new PMTSection(data);\n\n        for (var i = 0; i < pmt.pes_table.length; i++) {\n            this._add_pes_stream(pmt.pes_table[i], pmt);\n        }\n\n        return pmt;\n    }\n\n    /**\n     * @param stream\n     * @param pmt\n     */\n    private _add_pes_stream(stream: M2TS.PESTableItem, pmt: PMTSection): void {\n        let streams = this.pes_streams;\n\n        function get_program(id: number) {\n            for (let i = 0, item: M2TS.PSI_PES_Stream; i < streams.length; i++) {\n                item = streams[i];\n                if (item.id === id) {\n                    return {\n                        idx: i,\n                        item\n                    };\n                }\n            }\n            return null;\n        }\n\n        let p = get_program(stream.PID);\n        if (!p) {\n            streams.push({\n                id: stream.PID,\n                stream_type: stream.streamType,\n                duration: 0,\n                sps: [],\n                pps: [],\n                pixelRatio: [1, 1],\n                timescale: 90000, // (in TS timescale = 90kHz)\n                width: 0,\n                height: 0\n            });\n        }\n    }\n\n    /**\n     * Parse SDT Packet\n     * @param pack\n     */\n    // private _parseSdt(pack: Packet): SDTSection {\n    //     let data: Uint8Array;\n\n    //     if (pack.payload_unit_start_indicator) {\n    //         // psi has pointer_field\n    //         let pointer = pack.payload[0];\n\n    //         data = pack.payload.subarray(pointer + 1);\n    //     } else {\n    //         data = pack.payload;\n    //     }\n\n    //     let sdt = new SDTSection(data);\n\n    //     if (sdt.service_table.length > 0) {\n    //         this.metadata.service_name = sdt.service_table[0].name;\n    //         this.metadata.service_provider = sdt.service_table[0].provider_name;\n    //     }\n\n    //     return sdt;\n    // }\n}\n","/**\n * @file: complex.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Complex Stream.\n *\n * Combine Video, Audio, Caption c and other data.\n */\nimport Stream from '../../util/stream';\n\nclass M2TSComplexStream extends Stream {\n    constructor(ctx, psi) {\n        super();\n\n        /** @private */\n        this.context = ctx;\n\n        /** @private {PSI} */\n        this.PSI = psi;\n\n        /** @private {Object} */\n        this.videoTrack = null;\n\n        /** @private {Object} */\n        this.audioTrack = null;\n\n        /** @private {Object} */\n        this.captionTrack = null;\n\n        // pipe specified by outside.\n    }\n\n    push(data) {\n        let tracks = data;\n\n        for (let i = 0, track; i < tracks.length; i++) {\n            track = tracks[i];\n\n            switch (track.type) {\n                case 'video':\n                    // data -> GOPs\n                    this._complexVideo(track);\n                    break;\n                case 'audio':\n                    this._complexAudio(track);\n                    break;\n                case 'caption':\n                    this._complexCaption(track);\n                    break;\n            }\n        }\n    }\n\n    flush() {\n        this.emit('done');\n\n        this._clearStream();\n    }\n\n    reset() {\n        this._clearStream();\n\n        // This is demux end stream, so don't emit reset.\n        // this.emit('reset');\n    }\n\n    _clearStream() {\n        this.videoTrack = null;\n        this.audioTrack = null;\n        this.captionTrack = null;\n    }\n\n    _complexVideo(gops) {\n        let track = this.PSI.findTrack(gops.trackId);\n\n        if (track) {\n            track.type = 'video';\n            track.gops = gops;\n            track.firstDTS = gops[0][0].dts;\n            track.firstPTS = gops[0][0].pts;\n            // set duration to Infinity(POSITIVE_INFINITY) can be useful for live.\n            // If Infinity it will loose the ability to seek.\n            track.duration = Number.POSITIVE_INFINITY;\n\n            this.videoTrack = track;\n\n            this.emit('data', {\n                videoTrack: this.videoTrack\n            });\n        }\n    }\n\n    _complexAudio(frames) {\n        let track = this.PSI.findTrack(frames.trackId);\n\n        if (track) {\n            track.type = 'audio';\n            track.frames = frames;\n            track.firstPTS = track.firstDTS = frames[0].dts;\n\n            // set duration to Infinity(POSITIVE_INFINITY) can be useful for live.\n            // If Infinity it will loose the ability to seek.\n            track.duration = Number.POSITIVE_INFINITY;\n\n            this.audioTrack = track;\n\n            this.emit('data', {\n                audioTrack: this.audioTrack\n            });\n        }\n    }\n\n    _complexCaption() {}\n}\n\nexport default M2TSComplexStream;\n","/**\n * @file: platform.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * @description device\n */\nconst os = {\n    mac: false,\n    iphone: false,\n    android: false\n};\nconst browser = {\n    version: false,\n    CHROME: false,\n    SAFARI: false,\n    FIREFOX: false,\n    IE11: false,\n    IE: false,\n    EDGE: false,\n    WECHAT: false\n};\n\nlet nav = navigator;\n// let platform = nav.platform;\nlet ua = nav.userAgent.toLowerCase();\n\nvar match =\n    /(edge)\\/([\\w.]+)/.exec(ua) ||\n    /(opr)[/]([\\w.]+)/.exec(ua) ||\n    /(chrome)[ /]([\\w.]+)/.exec(ua) ||\n    /(firefox)[ /]([\\w.]+)/.exec(ua) ||\n    /(iemobile)[/]([\\w.]+)/.exec(ua) ||\n    /(version)(applewebkit)[ /]([\\w.]+).*(safari)[ /]([\\w.]+)/.exec(ua) ||\n    /(webkit)[ /]([\\w.]+).*(version)[ /]([\\w.]+).*(safari)[ /]([\\w.]+)/.exec(ua) ||\n    /(webkit)[ /]([\\w.]+)/.exec(ua) ||\n    /(opera)(?:.*version|)[ /]([\\w.]+)/.exec(ua) ||\n    /(msie) ([\\w.]+)/.exec(ua) ||\n    (ua.indexOf('trident') >= 0 && /(rv)(?::| )([\\w.]+)/.exec(ua)) ||\n    (ua.indexOf('compatible') < 0 && /(mozilla)(?:.*? rv:([\\w.]+)|)/.exec(ua)) ||\n    [];\n\nvar platform_match =\n    /(ipad)/.exec(ua) ||\n    /(ipod)/.exec(ua) ||\n    /(windows phone)/.exec(ua) ||\n    /(iphone)/.exec(ua) ||\n    /(kindle)/.exec(ua) ||\n    /(silk)/.exec(ua) ||\n    /(android)/.exec(ua) ||\n    /(win)/.exec(ua) ||\n    /(mac)/.exec(ua) ||\n    /(linux)/.exec(ua) ||\n    /(cros)/.exec(ua) ||\n    /(playbook)/.exec(ua) ||\n    /(bb)/.exec(ua) ||\n    /(blackberry)/.exec(ua) ||\n    [];\n\nvar result = {\n    version: undefined\n};\nvar matched = {\n    browser: match[5] || match[3] || match[1] || '',\n    version: match[2] || match[4] || '0',\n    versionNumber: match[4] || match[2] || '0',\n    platform: platform_match[0] || ''\n};\n\nif (matched.browser) {\n    result[matched.browser] = true;\n    // result.version = matched.version;\n    // result.versionNumber = parseInt(matched.versionNumber, 10);\n\n    let versionArray = matched.versionNumber.split('.');\n    result.version = {\n        major: parseInt(matched.versionNumber, 10),\n        string: matched.version\n    };\n    if (versionArray.length > 1) {\n        result.version.minor = parseInt(versionArray[1], 10);\n    }\n    if (versionArray.length > 2) {\n        result.version.build = parseInt(versionArray[2], 10);\n    }\n}\n\n// -------------------------------------- browser --------------------------------------\nbrowser.version = result.version;\nbrowser.CHROME = !!result['chrome'];\nbrowser.SAFARI = !!result['safari'] && !browser.CHROME;\nbrowser.FIREFOX = !!result['firefox'];\nbrowser.IE11 = /rv:11/.test(ua);\nbrowser.IE = !!result['msie'] || browser.IE11;\nbrowser.EDGE = !!result['edge'];\nbrowser.WECHAT = /(wechat)|(micromessenger)/.test(ua);\n\n// -------------------------------------- os --------------------------------------\n\nos.mac = !!matched.platform['mac'];\nos.iphone = !!matched.platform['iphone'];\nos.android = !!matched.platform['android'];\n\nexport default {\n    browser: browser,\n    os: os\n};\n","/**\n * @file: aac-config.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Audio Config Helper\n * Accord audioObjectType/samplingFrequencyIndex/channelCount, generate mimeType info.\n */\nimport platform from '../../util/platform';\nimport logger from '../../util/logger';\n\n/*\n    sampling freq,\n    0: 96000 Hz\n    1: 88200 Hz\n    2: 64000 Hz\n    3: 48000 Hz\n    4: 44100 Hz\n    5: 32000 Hz\n    6: 24000 Hz\n    7: 22050 Hz\n    8: 16000 Hz\n    9: 12000 Hz\n    10: 11025 Hz\n    11: 8000 Hz\n    12: 7350 Hz\n    13: Reserved\n    14: Reserved\n    15: frequency is written explictly\n */\nconst samplingRates = [96000, 88200, 64000, 48000, 44100, 32000, 24000, 22050, 16000, 12000, 11025, 8000, 7350];\n\nexport default (audioObjectType: number, samplingFrequencyIndex: number, channelCount: number) => {\n    let adtsExtensionSamplingIndex;\n    let realAudioObjectType = audioObjectType;\n    let config;\n\n    if (samplingFrequencyIndex > samplingRates.length - 1) {\n        logger.error(`invalid sampling index:${samplingFrequencyIndex}`);\n        return;\n    }\n\n    // firefox: freq less than 24kHz = AAC SBR (HE-AAC)\n    if (platform.browser.FIREFOX) {\n        if (samplingFrequencyIndex >= 6) {\n            audioObjectType = 5;\n            config = new Array(4);\n            // HE-AAC uses SBR (Spectral Band Replication) , high frequencies are constructed from low frequencies\n            // there is a factor 2 between frame sample rate and output sample rate\n            // multiply frequency by 2 (see table below, equivalent to substract 3)\n            adtsExtensionSamplingIndex = samplingFrequencyIndex - 3;\n        } else {\n            audioObjectType = 2;\n            config = new Array(2);\n            adtsExtensionSamplingIndex = samplingFrequencyIndex;\n        }\n        // Android : always use AAC\n    } else if (platform.os.android) {\n        audioObjectType = 2;\n        config = new Array(2);\n        adtsExtensionSamplingIndex = samplingFrequencyIndex;\n    } else {\n        /*  for other browsers (Chrome/Vivaldi/Opera ...)\n\t\t\t\talways force audio type to be HE-AAC SBR, as some browsers do not support audio codec switch properly (like Chrome ...)\n\t\t\t*/\n        audioObjectType = 5;\n        config = new Array(4);\n        // if (manifest codec is HE-AAC or HE-AACv2) OR (manifest codec not specified AND frequency less than 24kHz)\n        if (samplingFrequencyIndex >= 6) {\n            // HE-AAC uses SBR (Spectral Band Replication) , high frequencies are constructed from low frequencies\n            // there is a factor 2 between frame sample rate and output sample rate\n            // multiply frequency by 2 (see table below, equivalent to substract 3)\n            adtsExtensionSamplingIndex = samplingFrequencyIndex - 3;\n        } else {\n            // if (manifest codec is AAC) AND (frequency less than 24kHz AND nb channel is 1) OR (manifest codec not specified and mono audio)\n            // Chrome fails to play back with low frequency AAC LC mono when initialized with HE-AAC.  This is not a problem with stereo.\n            if (channelCount === 1) {\n                audioObjectType = 2;\n                config = new Array(2);\n            }\n            adtsExtensionSamplingIndex = samplingFrequencyIndex;\n        }\n    }\n    /* \n        refer to http://wiki.multimedia.cx/index.php?title=MPEG-4_Audio#Audio_Specific_Config ISO 14496-3 (AAC).pdf \n            - Table 1.13 — Syntax of AudioSpecificConfig()\n\t\t  Audio Profile / Audio Object Type\n\t\t  0: Null\n\t\t  1: AAC Main\n\t\t  2: AAC LC (Low Complexity)\n\t\t  3: AAC SSR (Scalable Sample Rate)\n\t\t  4: AAC LTP (Long Term Prediction)\n\t\t  5: SBR (Spectral Band Replication)\n\t\t  6: AAC Scalable\n\n\t\t  Channel Configurations\n\t\t  These are the channel configurations:\n\t\t  0: Defined in AOT Specifc Config\n\t\t  1: 1 channel: front-center\n\t\t  2: 2 channels: front-left, front-right\n\t\t*/\n    // audioObjectType = profile => profile, the MPEG-4 Audio Object Type minus 1\n    config[0] = audioObjectType << 3;\n    // samplingFrequencyIndex\n    config[0] |= (samplingFrequencyIndex & 0x0e) >> 1;\n    config[1] |= (samplingFrequencyIndex & 0x01) << 7;\n    // channelConfiguration\n    config[1] |= channelCount << 3;\n    if (audioObjectType === 5) {\n        // adtsExtensionSamplingIndex\n        config[1] |= (adtsExtensionSamplingIndex & 0x0e) >> 1;\n        config[2] = (adtsExtensionSamplingIndex & 0x01) << 7;\n        // audioObjectType (force to 2, chrome is checking that object type is less than 5 ???\n        //    https://chromium.googlesource.com/chromium/src.git/+/master/media/formats/mp4/aac.cc\n        config[2] |= 2 << 2;\n        config[3] = 0;\n    }\n\n    return {\n        config: config,\n        sampleRate: samplingRates[samplingFrequencyIndex],\n        channelCount: channelCount,\n        codec: 'mp4a.40.' + audioObjectType,\n        realCodec: 'mp4a.40.' + realAudioObjectType\n    };\n};\n","/**\n * @file: created at Saturday, 9th May 2020 11:13:19 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n// The AudioSpecificConfig is explained in ISO 14496-3.\nexport interface AudioSpecificConfig {\n    audioObjectType: number;\n    sampleCount: number;\n    channelConfiguration: number;\n    sampleRate: number;\n    samplingFrequencyIndex: number;\n    // assume ISO/IEC 14496-12 AudioSampleEntry default of 16\n}\n\nexport interface AACFrame extends Omit<AudioSpecificConfig, 'channelConfiguration'> {\n    pts: number;\n    dts: number;\n    data: Uint8Array;\n    channelCount: number; // equal to channelConfiguration\n    sampleSize: number;\n}\n\nexport const AAC_SAMPLING_FREQUENCIES = [\n    96000,\n    88200,\n    64000,\n    48000,\n    44100,\n    32000,\n    24000,\n    22050,\n    16000,\n    12000,\n    11025,\n    8000,\n    7350\n];\n","/**\n * @file: adts.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * ADTS codec\n * Wiki Refer: https://wiki.multimedia.cx/index.php?title=ADTS\n */\nimport EventEmitter from '../util/event-emitter';\nimport { AACFrame, AAC_SAMPLING_FREQUENCIES } from './aac/aac';\n\nexport type AACCodecData = {\n    pts: number;\n    dts: number;\n    payload: Uint8Array;\n};\n\n/**\n * @extends EventEmitter\n */\nclass ADTSCodec extends EventEmitter {\n    constructor() {\n        super();\n    }\n\n    push(data: AACCodecData) {\n        let { pts, dts, payload } = data;\n        let data_byte = payload;\n        let i = 0,\n            frameNum = 0,\n            frameLength,\n            protectionSkipBytes,\n            frameEnd,\n            sampleCount,\n            adtsFrameDuration;\n\n        while (i + 5 < data_byte.length) {\n            // Look for the start of an ADTS header..\n            if (data_byte[i] !== 0xff || (data_byte[i + 1] & 0xf6) !== 0xf0) {\n                // If a valid header was not found,  jump one forward and attempt to\n                // find a valid ADTS header starting at the next byte\n                i++;\n                continue;\n            }\n\n            // The protection skip bit tells us if we have 2 bytes of CRC data at the\n            // end of the ADTS header\n            protectionSkipBytes = (~data_byte[i + 1] & 0x01) * 2;\n\n            // Frame length is a 13 bit integer starting 16 bits from the\n            // end of the sync sequence\n            frameLength =\n                ((data_byte[i + 3] & 0x03) << 11) | (data_byte[i + 4] << 3) | ((data_byte[i + 5] & 0xe0) >> 5);\n\n            sampleCount = ((data_byte[i + 6] & 0x03) + 1) * 1024;\n            adtsFrameDuration = (sampleCount * 90000) / AAC_SAMPLING_FREQUENCIES[(data_byte[i + 2] & 0x3c) >>> 2];\n\n            frameEnd = i + frameLength;\n\n            // If we don't have enough data to actually finish this ADTS frame, return\n            // and wait for more data\n            if (data_byte.byteLength < frameEnd) {\n                return;\n            }\n\n            let aacFrame: AACFrame = {\n                pts: pts + frameNum * adtsFrameDuration,\n                dts: dts + frameNum * adtsFrameDuration,\n                sampleCount: sampleCount,\n                audioObjectType: ((data_byte[i + 2] >>> 6) & 0x03) + 1,\n                channelCount: ((data_byte[i + 2] & 1) << 2) | ((data_byte[i + 3] & 0xc0) >>> 6),\n                sampleRate: AAC_SAMPLING_FREQUENCIES[(data_byte[i + 2] & 0x3c) >>> 2],\n                samplingFrequencyIndex: (data_byte[i + 2] & 0x3c) >>> 2,\n                // assume ISO/IEC 14496-12 AudioSampleEntry default of 16\n                sampleSize: 16,\n                data: data_byte.subarray(i + 7 + protectionSkipBytes, frameEnd)\n            };\n            // Otherwise, deliver the complete AAC frame\n            this.emit('frame', aacFrame);\n\n            // If the data_byte is empty, clear it and return\n            if (data_byte.byteLength === frameEnd) {\n                data_byte = undefined;\n\n                this.emit('done');\n                return;\n            }\n\n            frameNum++;\n\n            // Remove the finished frame from the data_byte and start the process again\n            data_byte = data_byte.subarray(frameEnd);\n        }\n    }\n}\n\nexport default ADTSCodec;\n","/**\n * @file: adts.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * ADTS(Audio Data Transport Stream) Stream.\n */\nimport { AACFrame } from '../../codec/aac/aac';\nimport getAudioConfig from '../../codec/aac/aac-config';\nimport ADTSCodec from '../../codec/adts';\nimport { StreamTypes } from '../../enum/stream-types';\nimport Stream from '../../util/stream';\nimport { PSI } from '../psi';\nimport { AACFrameVector, PESStreamEmitData } from '../types/pipeline';\n\nclass ADTSStream extends Stream {\n    private PSI: PSI;\n    private trackId?: number;\n    private codec: ADTSCodec;\n    private frames: AACFrameVector;\n\n    constructor(psi: PSI) {\n        super();\n\n        this.PSI = psi;\n        this.trackId = null;\n\n        /** @private {ADTSCodec} */\n        this.codec = new ADTSCodec();\n\n        this.codec.on('frame', (frame: AACFrame) => {\n            this.frames.push(frame);\n            this.frames.byteLength += frame.data.byteLength;\n            this.frames.trackId = this.trackId;\n        });\n\n        this._newFrames();\n    }\n\n    push(data: PESStreamEmitData) {\n        if (data.stream_type === StreamTypes.ADTS) {\n            this.trackId = data.pid;\n\n            this.codec.push({\n                dts: data.pes.DTS,\n                pts: data.pes.PTS,\n                payload: data.pes.data_byte\n            });\n        }\n    }\n\n    flush() {\n        if (this.frames.length > 0) {\n            let count = this.frames.length;\n            let firstFrame = this.frames[0];\n            let lastFrame = this.frames[count - 1];\n            let lastDuration = (lastFrame.sampleRate * lastFrame.sampleCount) / 90000;\n\n            this.frames.firstDTS = firstFrame.dts;\n            this.frames.firstPTS = firstFrame.pts;\n\n            if (count === 1) {\n                this.frames.duration = lastDuration;\n            } else {\n                this.frames.duration = lastDuration + (lastFrame.pts - firstFrame.pts);\n            }\n\n            // To prevent information mismatch leading to next pipeline decoding errors\n            // Every audio frame list assembly needs to update track meta.\n            this._updateTrackMeta(firstFrame);\n\n            this.emit('data', this.frames);\n\n            this.reset();\n            this.emit('done');\n        }\n    }\n\n    reset() {\n        this.trackId = null;\n        this._newFrames();\n    }\n\n    _newFrames() {\n        this.frames = []; // aac frames\n        this.frames.type = 'audio';\n        this.frames.byteLength = 0;\n        this.frames.duration = 0;\n        this.frames.firstDTS = 0;\n        this.frames.firstPTS = 0;\n    }\n\n    /**\n     * @param {Object} frame\n     */\n    _updateTrackMeta(frame: AACFrame) {\n        let track = this.PSI.findTrack(this.trackId);\n        let config = getAudioConfig(frame.audioObjectType, frame.samplingFrequencyIndex, frame.channelCount);\n        track.config = config.config;\n        track.sampleRate = config.sampleRate;\n        track.inputTimeScale = track.inputTimeScale || track.timescale;\n        track.timescale = config.sampleRate;\n        track.channelCount = config.channelCount;\n        track.codec = config.codec;\n        track.realCodec = config.realCodec;\n        track.isAAC = true;\n    }\n}\n\nexport default ADTSStream;\n","/**\n * @file: dv.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Bit buffer reader like DataView.\n */\n\nfunction read(buf: ArrayBuffer | Uint8Array): DataView {\n    let byteOffset = 0;\n\n    if (ArrayBuffer.isView(buf)) {\n        byteOffset = buf.byteOffset;\n        buf = buf.buffer;\n    }\n\n    return new DataView(buf, byteOffset);\n}\n\nclass DataViewReader {\n    constructor() {}\n\n    /**\n     * Gets an unsigned 8-bit integer (unsigned byte).\n     * @param buffer\n     * @param byteOffset    The offset, in byte, from the start of the view where to read the data.\n     * @returns {number}    An unsigned 8-bit integer number.\n     */\n    readUint8(buffer: ArrayBuffer | Uint8Array, byteOffset: number): number {\n        return read(buffer).getUint8(byteOffset);\n    }\n\n    /**\n     * Gets an unsigned 16-bit integer (unsigned long).\n     * @param buffer\n     * @param byteOffset     The offset, in byte, from the start of the view where to read the data.\n     * @param littleEndian   Indicates whether the 16-bit int is stored in little- or big-endian format.\n     * @returns {number}     An unsigned 16-bit integer number.\n     */\n    readUint16(buffer: ArrayBuffer | Uint8Array, byteOffset, littleEndian: boolean = false): number {\n        return read(buffer).getUint16(byteOffset, littleEndian);\n    }\n\n    /**\n     * Gets an unsigned 32-bit integer (unsigned long).\n     * @param buffer\n     * @param byteOffset        The offset, in byte, from the start of the view where to read the data.\n     * @param littleEndian      Indicates whether the 32-bit int is stored in little- or big-endian format.\n     * @returns {number}        An unsigned 32-bit integer number.\n     */\n    readUint32(buffer: ArrayBuffer | Uint8Array, byteOffset: number, littleEndian: boolean = false): number {\n        return read(buffer).getUint32(byteOffset, littleEndian);\n    }\n}\n\nexport default DataViewReader;\n","/**\n * @file: ep3b.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * discard the emulation_prevention_three_byte\n * @param data\n */\nexport default function discardEP3B(data: Uint8Array): Uint8Array {\n    let length = data.byteLength,\n        emulationPreventionBytesPositions = [],\n        i = 1,\n        newLength: number,\n        newData = new Uint8Array(0);\n\n    // Find all `Emulation Prevention Bytes`\n    while (i < length - 2) {\n        if (data[i] === 0 && data[i + 1] === 0 && data[i + 2] === 0x03) {\n            emulationPreventionBytesPositions.push(i + 2);\n            i += 2;\n        } else {\n            i++;\n        }\n    }\n\n    // If no Emulation Prevention Bytes were found just return the original\n    // array\n    if (emulationPreventionBytesPositions.length === 0) {\n        return data;\n    }\n\n    // Create a new array to hold the NAL unit data\n    newLength = length - emulationPreventionBytesPositions.length;\n\n    try {\n        newData = new Uint8Array(newLength);\n    } catch (e) {\n        throw `epsb alloc mem error ${newLength}`;\n    }\n    let sourceIndex = 0;\n\n    for (i = 0; i < newLength; sourceIndex++, i++) {\n        if (sourceIndex === emulationPreventionBytesPositions[0]) {\n            // Skip this byte\n            sourceIndex++;\n            // Remove this position index\n            emulationPreventionBytesPositions.shift();\n        }\n        newData[i] = data[sourceIndex];\n    }\n\n    return newData;\n}\n","/**\n * @file: exp-golumb.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * exp golumb algorithm.\n * codeNum = 2leadingZeroBits – 1 + read_bits( leadingZeroBits )\n * @see https://en.wikipedia.org/wiki/Exponential-Golomb_coding\n */\n\n/**\n * read n bit.\n * @param buffer\n * @param bitOffset\n * @param length\n * @private\n */\nexport function readBit(buffer: Uint8Array, bitOffset: number = 0, length: number = 1): number {\n    let startByte = 0;\n    let startByteBitPos = 0;\n    let val = 0;\n    let bitStr = '',\n        bitVal = 0;\n\n    for (let j = bitOffset; j < bitOffset + length; j++) {\n        startByte = Math.floor(j / 8);\n        startByteBitPos = 7 - (j % 8);\n        bitVal = (buffer[startByte] >> startByteBitPos) & 0x01;\n\n        bitStr += bitVal;\n    }\n\n    val = parseInt(bitStr, 2);\n\n    return val;\n}\n\n/**\n * read 1 byte.\n * @param buffer\n * @param bitOffset\n */\nexport function readByte(buffer: Uint8Array, bitOffset: number = 0) {\n    return readBit(buffer, bitOffset, 8);\n}\n\n/**\n * Unsigned Integer Exp-Golomb Coded.\n * @param buffer\n * @param bitOffset\n */\nexport function readUEV(buffer: Uint8Array, bitOffset: number = 0) {\n    let leadingZeros = [];\n    let bitLength = buffer.byteLength * 8;\n    let readBit1 = false;\n    let startByte = 0;\n    let startByteBitPos = 0;\n    let bitVal = 0;\n    let value = '';\n\n    // 1. 计算 leadingZeros\n    for (let i = bitOffset; i < bitLength; i++) {\n        startByte = Math.floor(i / 8);\n        startByteBitPos = 7 - (i % 8);\n\n        bitVal = (buffer[startByte] >> startByteBitPos) & 0x01;\n\n        if (!readBit1) {\n            if (bitVal === 0) {\n                leadingZeros.push(0);\n            } else {\n                readBit1 = true;\n                bitOffset = i;\n                break;\n            }\n        }\n    }\n\n    let codeNumLength = leadingZeros.length + 1;\n\n    // 2. 计算有效位数值\n    for (let j = bitOffset; j < bitOffset + codeNumLength; j++) {\n        startByte = Math.floor(j / 8);\n        startByteBitPos = 7 - (j % 8);\n        bitVal = (buffer[startByte] >> startByteBitPos) & 0x01;\n\n        value += bitVal;\n    }\n\n    return {\n        bitLength: leadingZeros.length + codeNumLength,\n        value: parseInt(value, 2) - 1\n    };\n}\n\n/**\n * Signed Integer Exp-Golomb Coded.\n * @param buffer\n * @param bitOffset\n */\nexport function readSEV(buffer: Uint8Array, bitOffset: number = 0) {\n    let uev = readUEV(buffer, bitOffset);\n    let codeNum = uev.value;\n\n    let signedValue = Math.pow(-1, codeNum + 1) * Math.ceil(codeNum / 2);\n\n    return {\n        bitLength: uev.bitLength,\n        value: signedValue\n    };\n}\n\nexport default {\n    readUEV,\n    readSEV,\n    readBit,\n    readByte\n};\n","/**\n * @file: sps.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport ExpGolomb from '../../util/exp-golumb';\n\nlet bitOffset = 0;\n\nexport type SPSProps = {\n    profile_idc: number;\n    profile_compatibility: number;\n    level_idc: number;\n    sps_id: number;\n    log2_max_frame_num_minus4: number;\n    pic_order_cnt_type: number;\n    log2_max_pic_order_cnt_lsb_minus4: number;\n\n    width: number;\n    height: number;\n\n    pixelRatio: [number, number];\n    payload: Uint8Array;\n\n    video_format: number;\n\n    fps: number;\n    fixedFPS: boolean;\n};\n\n/**\n * 7.3.2.1.1.1 Scaling list syntax\n * @param scalingList\n * @param size\n */\nfunction scaling_list(scalingList, size) {\n    let lastScale = 8;\n    let nextScale = 8;\n    let delta_scale;\n\n    for (var j = 0; j < size; j++) {\n        if (nextScale != 0) {\n            delta_scale = ExpGolomb.readUEV(scalingList, bitOffset);\n            bitOffset += delta_scale.bitLength;\n\n            nextScale = (lastScale + delta_scale.value + 256) % 256;\n        }\n\n        lastScale = scalingList[j];\n    }\n}\n\n/**\n * decode (SPS)Sequence parameter set\n * @param payload\n */\nexport function decodeSPS(payload: Uint8Array): SPSProps {\n    bitOffset = 0;\n\n    let profile_idc = payload[0];\n    let profile_compatibility = payload[1];\n    let level_idc = payload[2];\n    let golombBuffer = payload.subarray(3);\n    let //separate_colour_plane_flag = 0,\n        // qpprime_y_zero_transform_bypass_flag = 0,\n        seq_scaling_matrix_present_flag = 0;\n    let lmpoclmUEV;\n    let //delta_pic_order_always_zero_flag = 0,\n        ofnrpSEV,\n        ofttbfSEV,\n        nrfipoccUEV;\n    let pixelRatio: [number, number] = [1, 1],\n        pixelScale = 1;\n    let video_format: number;\n    let fps = 0,\n        num_units_in_tick: number,\n        time_scale: number,\n        fixed_frame_rate_flag: boolean = true;\n\n    // seq_parameter_set_id\n    let spsUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n    bitOffset += spsUEV.bitLength;\n\n    if (\n        profile_idc == 100 ||\n        profile_idc == 110 ||\n        profile_idc == 122 ||\n        profile_idc == 244 ||\n        profile_idc == 44 ||\n        profile_idc == 83 ||\n        profile_idc == 86 ||\n        profile_idc == 118 ||\n        profile_idc == 128\n    ) {\n        // chroma_format_idc\n        let chromaFIUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n        bitOffset += chromaFIUEV.bitLength;\n\n        if (chromaFIUEV.value == 3) {\n            // separate_colour_plane_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n            bitOffset += 1;\n        }\n\n        // bit_depth_luma_minus8\n        let bitdlmUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n        bitOffset += bitdlmUEV.bitLength;\n\n        // bit_depth_chroma_minus8\n        let bitdcmUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n        bitOffset += bitdcmUEV.bitLength;\n\n        // qpprime_y_zero_transform_bypass_flag\n        // qpprime_y_zero_transform_bypass_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n        bitOffset += 1;\n\n        // seq_scaling_matrix_present_flag\n        seq_scaling_matrix_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n        bitOffset += 1;\n\n        if (seq_scaling_matrix_present_flag) {\n            for (let i = 0; i < (chromaFIUEV.value != 3 ? 8 : 12); i++) {\n                let seq_scaling_list_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n                bitOffset += 1;\n\n                if (seq_scaling_list_present_flag) {\n                    if (i < 6) {\n                        scaling_list(golombBuffer, 16);\n                    } else {\n                        scaling_list(golombBuffer, 64);\n                    }\n                }\n            }\n        }\n    }\n\n    // log2_max_frame_num_minus4\n    let lmfnmUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n    bitOffset += lmfnmUEV.bitLength;\n\n    // pic_order_cnt_type\n    let poctUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n    let pic_order_cnt_type = poctUEV.value;\n    bitOffset += poctUEV.bitLength;\n\n    if (pic_order_cnt_type === 0) {\n        // log2_max_pic_order_cnt_lsb_minus4\n        lmpoclmUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n        bitOffset += lmpoclmUEV.bitLength;\n    } else if (pic_order_cnt_type === 1) {\n        // delta_pic_order_always_zero_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n        bitOffset += 1;\n\n        // offset_for_non_ref_pic\n        ofnrpSEV = ExpGolomb.readSEV(golombBuffer, bitOffset);\n        bitOffset += ofnrpSEV.bitLength;\n\n        // offset_for_top_to_bottom_field\n        ofttbfSEV = ExpGolomb.readSEV(golombBuffer, bitOffset);\n        bitOffset += ofttbfSEV.bitLength;\n\n        // num_ref_frames_in_pic_order_cnt_cycle\n        nrfipoccUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n        bitOffset += nrfipoccUEV.bitLength;\n\n        // let offset_for_ref_frames = [];\n        for (let i = 0, item; i < nrfipoccUEV.value; i++) {\n            item = ExpGolomb.readSEV(golombBuffer, bitOffset);\n            bitOffset += item.bitLength;\n\n            // offset_for_ref_frames.push(item);\n        }\n    }\n\n    // max_num_ref_frames\n    // 指定参考帧队列可能达到的最大长度，解码器依照这个句法元素的值开辟存储区，这个存储区用于存放已解码的参考帧，\n    // H.264 规定最多可用 16 个参考帧，本句法元素的值最大为 16。值得注意的是这个长度以帧为单位，如果在场模式下，应该相应地扩展一倍\n    let mnrfUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n    bitOffset += mnrfUEV.bitLength;\n\n    // gaps_in_frame_num_value_allowed_flag\n    // let gaps_in_frame_num_value_allowed_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n    bitOffset += 1;\n\n    // pic_width_in_mbs_minus1\n    let picWidthUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n    bitOffset += picWidthUEV.bitLength;\n\n    // pic_height_in_map_units_minus1\n    let picHeightUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n    bitOffset += picHeightUEV.bitLength;\n\n    // frame_mbs_only_flag\n    // 本句法元素等于 1 时, 表示本序列中所有图像的编码模式都是帧编码；\n    // 本句法元素等于 0 时, 表示本序列中图像的编码模式可能是帧，也可能是场或帧场自适应，某个图像具体是哪一种要由其他句法元素决定。\n    let frame_mbs_only_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n    bitOffset += 1;\n\n    if (!frame_mbs_only_flag) {\n        // mb_adaptive_frame_field_flag (Unused, Unnecessary to read it.)\n        // ExpGolomb.readBit(golombBuffer, bitOffset);\n        bitOffset += 1;\n    }\n\n    // direct_8x8_inference_flag,  用于指明 B 片的直接 和 skip 模式下运动矢量的预测方法\n    // let direct_8x8_inference_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n    bitOffset += 1;\n\n    // frame_cropping_flag, 用于指明解码器是否要将图像裁剪后输出，如果是的话，后面紧跟着的四个句法元素分别指出左右、上下裁剪的宽度\n    let frame_cropping_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n    bitOffset += 1;\n\n    let cropLeft = 0,\n        cropRight = 0,\n        cropTop = 0,\n        cropBottom = 0;\n    if (frame_cropping_flag) {\n        let fcloUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n        bitOffset += fcloUEV.bitLength;\n        cropLeft = fcloUEV.value;\n\n        let fcroUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n        bitOffset += fcroUEV.bitLength;\n        cropRight = fcroUEV.value;\n\n        let fctoUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n        bitOffset += fctoUEV.bitLength;\n        cropTop = fctoUEV.value;\n\n        let fcboUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n        bitOffset += fcboUEV.bitLength;\n        cropBottom = fcboUEV.value;\n    }\n\n    // vui_parameters_present_flag\n    let vui_parameters_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n    bitOffset += 1;\n\n    if (vui_parameters_present_flag) {\n        // Annex E, E.1.1 VUI parameters syntax\n        // VUI 用以表征视频格式等额外信息\n        // aspect_ratio, video_format\n\n        let aspect_ratio_info_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n        bitOffset += 1;\n\n        if (aspect_ratio_info_present_flag) {\n            const aspectRatioIdc = ExpGolomb.readByte(golombBuffer, bitOffset);\n            bitOffset += 8;\n\n            switch (aspectRatioIdc) {\n                case 1:\n                    pixelRatio = [1, 1];\n                    break;\n                case 2:\n                    pixelRatio = [12, 11];\n                    break;\n                case 3:\n                    pixelRatio = [10, 11];\n                    break;\n                case 4:\n                    pixelRatio = [16, 11];\n                    break;\n                case 5:\n                    pixelRatio = [40, 33];\n                    break;\n                case 6:\n                    pixelRatio = [24, 11];\n                    break;\n                case 7:\n                    pixelRatio = [20, 11];\n                    break;\n                case 8:\n                    pixelRatio = [32, 11];\n                    break;\n                case 9:\n                    pixelRatio = [80, 33];\n                    break;\n                case 10:\n                    pixelRatio = [18, 11];\n                    break;\n                case 11:\n                    pixelRatio = [15, 11];\n                    break;\n                case 12:\n                    pixelRatio = [64, 33];\n                    break;\n                case 13:\n                    pixelRatio = [160, 99];\n                    break;\n                case 14:\n                    pixelRatio = [4, 3];\n                    break;\n                case 15:\n                    pixelRatio = [3, 2];\n                    break;\n                case 16:\n                    pixelRatio = [2, 1];\n                    break;\n                case 255: {\n                    let width0 = ExpGolomb.readByte(golombBuffer, bitOffset);\n                    bitOffset += 8;\n                    let width1 = ExpGolomb.readByte(golombBuffer, bitOffset);\n                    bitOffset += 8;\n                    let height0 = ExpGolomb.readByte(golombBuffer, bitOffset);\n                    bitOffset += 8;\n                    let height1 = ExpGolomb.readByte(golombBuffer, bitOffset);\n                    bitOffset += 8;\n                    pixelRatio = [(width0 << 8) | width1, (height0 << 8) | height1];\n                    break;\n                }\n            }\n\n            if (pixelRatio) {\n                pixelScale = pixelRatio[0] / pixelRatio[1];\n            }\n\n            if (aspectRatioIdc === 255) {\n                // sar_width\n                bitOffset += 16;\n                // sar_height\n                bitOffset += 16;\n            }\n        }\n\n        let overscan_info_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n        bitOffset += 1;\n\n        if (overscan_info_present_flag) {\n            bitOffset += 1;\n            // overscan_appropriate_flag;\n        }\n\n        let video_signal_type_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n        bitOffset += 1;\n\n        if (video_signal_type_present_flag) {\n            /*\n                Table E-2 – Meaning of video_format\n                video_format    Meaning\n                0               Component\n                1               PAL\n                2               NTSC\n                3               SECAM\n                4               MAC\n                5               Unspecified video format\n                6               Reserved\n                7               Reserved\n             */\n            video_format = ExpGolomb.readBit(golombBuffer, bitOffset, 3);\n            bitOffset += 3;\n\n            // switch (video_format) {\n            // }\n\n            // let video_full_range_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n            bitOffset += 1;\n\n            let colour_description_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n            bitOffset += 1;\n\n            if (colour_description_present_flag) {\n                // colour_primaries            u(8)\n                // transfer_characteristics    u(8)\n                // matrix_coefficients         u(8)\n                bitOffset += 24;\n            }\n        }\n\n        let chroma_loc_info_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n        bitOffset += 1;\n\n        if (chroma_loc_info_present_flag) {\n            let chroma_sample_loc_type_top_field = ExpGolomb.readUEV(golombBuffer, bitOffset);\n            bitOffset += chroma_sample_loc_type_top_field.bitLength;\n\n            let chroma_sample_loc_type_bottom_field = ExpGolomb.readUEV(golombBuffer, bitOffset);\n            bitOffset += chroma_sample_loc_type_bottom_field.bitLength;\n        }\n\n        let timing_info_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n        bitOffset += 1;\n\n        if (timing_info_present_flag) {\n            num_units_in_tick = ExpGolomb.readBit(golombBuffer, bitOffset, 32);\n            bitOffset += 32;\n\n            time_scale = ExpGolomb.readBit(golombBuffer, bitOffset, 32);\n            bitOffset += 32;\n\n            fixed_frame_rate_flag = !!ExpGolomb.readBit(golombBuffer, bitOffset);\n            bitOffset += 1;\n\n            fps = time_scale / (num_units_in_tick * 2);\n        }\n\n        // There is left VUI other's parameters to be decoded ...\n        // For now, it is useless, so don't pass them.\n    }\n\n    // let FrameHeightInMbs = (2 - frame_mbs_only_flag) * (picHeightUEV.value + 1);\n    // PicSizeInMapUnits = PicWidthInMbs * PicHeightInMapUnits\n\n    return {\n        payload: golombBuffer,\n\n        profile_idc,\n        profile_compatibility,\n        level_idc,\n        sps_id: spsUEV.value, // ue(v)\n        log2_max_frame_num_minus4: poctUEV.value, // ue(v)\n        pic_order_cnt_type, // ue(v)\n        log2_max_pic_order_cnt_lsb_minus4: lmpoclmUEV ? lmpoclmUEV.value : 0, // ue(v)\n\n        width: Math.ceil(((picWidthUEV.value + 1) * 16 - cropLeft * 2 - cropRight * 2) * pixelScale), // PicWidthInSamplesL = PicWidthInMbs * 16\n        height: (2 - frame_mbs_only_flag) * (picHeightUEV.value + 1) * 16 - cropTop * 2 - cropBottom * 2,\n\n        pixelRatio,\n        video_format,\n\n        fps,\n        fixedFPS: fixed_frame_rate_flag\n    };\n}\n","/**\n * @file: pps.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport ExpGolomb from '../../util/exp-golumb';\n\nexport type PPSProps = {\n    sliceGroupNum: number;\n};\n\n/**\n * decode (PPS)Picture parameter set\n * @param payload\n */\nexport function decodePPS(payload: Uint8Array): PPSProps {\n    let bitOffset = 0;\n\n    let golombBuffer = payload;\n    let //slice_group_change_direction_flag = 0,\n        sliceGroupIds = [];\n    let sgcdfUEV, picSizeUEV;\n    let i = 0;\n\n    // pic_parameter_set_id\n    let ppsUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n    bitOffset += ppsUEV.bitLength;\n\n    // seq_parameter_set_id\n    let spsUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n    bitOffset += spsUEV.bitLength;\n\n    // entropy_coding_mode_flag\n    // 0: Exp-Golomb coded, see subclause 9.1 or CAVLC, see subclause 9.2\n    // 1: CABAC, see subclause 9.3\n    // let entropy_coding_mode_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n    bitOffset += 1;\n\n    // bottom_field_pic_order_in_frame_present_flag\n    // let bottom_field_pic_order_in_frame_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n    bitOffset += 1;\n\n    // num_slice_groups_minus1,\n    let sliceGroupUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n    bitOffset += sliceGroupUEV.bitLength;\n\n    if (sliceGroupUEV.value > 0) {\n        // slice_group_map_type\n        let sgmtUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n        bitOffset += sgmtUEV.bitLength;\n\n        let iGroup = 0,\n            itemUev;\n\n        switch (sgmtUEV.value) {\n            case 0:\n                for (iGroup = 0; iGroup <= sgmtUEV.value; iGroup++) {\n                    // run_length_minus1\n                    itemUev = ExpGolomb.readUEV(golombBuffer, bitOffset);\n                    bitOffset += itemUev.bitLength;\n                }\n                break;\n            case 2:\n                for (iGroup = 0; iGroup <= sgmtUEV.value; iGroup++) {\n                    // top_left\n                    itemUev = ExpGolomb.readUEV(golombBuffer, bitOffset);\n                    bitOffset += itemUev.bitLength;\n                    // bottom_right\n                    itemUev = ExpGolomb.readUEV(golombBuffer, bitOffset);\n                    bitOffset += itemUev.bitLength;\n                }\n                break;\n            case 3:\n            case 4:\n            case 5:\n                // slice_group_change_direction_flag\n                // slice_group_change_direction_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n                bitOffset += 1;\n                // slice_group_change_rate_minus1\n                sgcdfUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n                bitOffset += sgcdfUEV.bitLength;\n                break;\n            case 6:\n                {\n                    // pic_size_in_map_units_minus1\n                    picSizeUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n                    bitOffset += picSizeUEV.bitLength;\n\n                    let length = Math.ceil(Math.log2(sliceGroupUEV.value + 1));\n                    for (i = 0; i <= picSizeUEV.value; i++) {\n                        // pic_size_in_map_units_minus1\n                        sliceGroupIds.push(ExpGolomb.readBit(golombBuffer, bitOffset, length));\n                        bitOffset += length;\n                    }\n                }\n                break;\n        }\n    }\n\n    // num_ref_idx_l0_default_active_minus1\n    let nril0dcmUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n    bitOffset += nril0dcmUEV.bitLength;\n\n    // num_ref_idx_l1_default_active_minus1\n    let nril1dcmUEV = ExpGolomb.readUEV(golombBuffer, bitOffset);\n    bitOffset += nril1dcmUEV.bitLength;\n\n    // weighted_pred_flag\n    // let weighted_pred_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n    bitOffset += 1;\n\n    // weighted_bipred_idc\n    // let weighted_bipred_idc = ExpGolomb.readBit(golombBuffer, bitOffset, 2);\n    bitOffset += 1;\n\n    // pic_init_qp_minus26\n    let piqpSEV = ExpGolomb.readSEV(golombBuffer, bitOffset);\n    bitOffset += piqpSEV.bitLength;\n    // pic_init_qs_minus26\n    let piqsSEV = ExpGolomb.readSEV(golombBuffer, bitOffset);\n    bitOffset += piqsSEV.bitLength;\n    // chroma_qp_index_offset\n    let cqioSEV = ExpGolomb.readSEV(golombBuffer, bitOffset);\n    bitOffset += cqioSEV.bitLength;\n\n    // let deblocking_filter_control_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n    bitOffset += 1;\n    // let constrained_intra_pred_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n    bitOffset += 1;\n    // let redundant_pic_cnt_present_flag = ExpGolomb.readBit(golombBuffer, bitOffset);\n    bitOffset += 1;\n\n    // if( more_rbsp_data( ) ) {\n    //     // Unused data...\n    // }\n\n    return {\n        sliceGroupNum: sliceGroupUEV.value + 1\n    };\n}\n","/**\n * @file: pps.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nexport type SEIProps = {};\n\n/**\n * decode (SEI)Supplemental enhancement information\n * @param payload\n */\nexport function decodeSEI(payload: Uint8Array): SEIProps {\n    payload;\n    return {};\n}\n","/**\n * @file: nalu.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport DataViewReader from '../../util/dv';\nimport NaluTypes from '../../enum/nalu-types';\nimport discardEP3B from './ep3b';\nimport { decodeSPS, SPSProps } from './sps';\nimport { decodePPS, PPSProps } from './pps';\nimport { decodeSEI, SEIProps } from './sei';\n\n/**\n * decode (AUD)Access unit delimiter\n * @param payload\n * @private\n */\nfunction _decodeAUD(payload: Uint8Array): number {\n    // var primary_pic_type_table = {\n    //     0x084, // 2, 7\n    //     0x0a5, // 0, 2, 5, 7\n    //     0x0e7, // 0, 1, 2, 5, 6, 7\n    //     0x210, // 4, 9\n    //     0x318, // 3, 4, 8, 9\n    //     0x294, // 2, 4, 7, 9\n    //     0x3bd, // 0, 2, 3, 4, 5, 7, 8, 9\n    //     0x3ff, // 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\n    // }\n\n    return payload[0] >> 5;\n}\n\nexport default class NALU extends DataViewReader {\n    forbidden_zero_bit: number;\n    ref_idc: number;\n    unit_type: number;\n    data: Uint8Array;\n    rawData: Uint8Array;\n    sps: SPSProps;\n    pps: PPSProps;\n    sei: SEIProps;\n    primary_pic_type: number;\n    pts?: number;\n    dts?: number;\n\n    constructor(buffer: Uint8Array) {\n        super();\n\n        this.forbidden_zero_bit = buffer[0] >> 7;\n\n        // nalu priority.\n        this.ref_idc = (buffer[0] >> 5) & 0x03;\n\n        // specifies the type of RBSP data structure. see in mux-nalu-types.js\n        this.unit_type = buffer[0] & 0x1f;\n\n        this.data = discardEP3B(buffer.subarray(1));\n        this.rawData = buffer;\n\n        switch (this.unit_type) {\n            case NaluTypes.NON_IDR_SLICE:\n                break;\n            case NaluTypes.DPA_SLICE:\n            case NaluTypes.DPB_SLICE:\n            case NaluTypes.DPC_SLICE:\n                // TODO decode A/B/C Partition Slice.\n                break;\n            case NaluTypes.IDR_SLICE:\n                // this.data = decodeSlice(this.data).data;\n                break;\n            case NaluTypes.SPS:\n                this.sps = decodeSPS(this.data);\n                break;\n            case NaluTypes.PPS:\n                this.pps = decodePPS(this.data);\n                break;\n            case NaluTypes.SEI:\n                this.sei = decodeSEI(this.data);\n                break;\n            case NaluTypes.AUD:\n                this.primary_pic_type = _decodeAUD(this.data);\n                break;\n        }\n    }\n}\n","/**\n * @file: avc.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * h.264/AVC codec\n */\nimport CacheBuffer from '../util/cache-buffer';\nimport EventEmitter from '../util/event-emitter';\nimport logger from '../util/logger';\nimport NALU from './avc/nalu';\n\nexport type AVCCodecData = {\n    pts: number;\n    dts: number;\n    naluSizeLength?: number;\n    payload: Uint8Array;\n};\n\nexport interface AVCDecoderConfigurationRecord {\n    version: number;\n    profile: number;\n    profileCompatibility: number;\n    level: number;\n    naluSizeLength: number;\n    spsNalus: Uint8Array[];\n    ppsNalus: Uint8Array[];\n}\n\ntype ParsePesState = 0 | 1 | 2 | 3;\n\nexport class AVCCodec extends EventEmitter {\n    private lastState: ParsePesState = null;\n    private lastNALu: NALU = null;\n    private lastNALuState: ParsePesState = null;\n\n    private spitNalu_(bytes: Uint8Array, pts: number, dts: number) {\n        let nalu: NALU = new NALU(bytes);\n\n        nalu.pts = pts;\n        nalu.dts = dts;\n\n        this.lastNALu = nalu;\n        this.emit('nalu', nalu);\n    }\n\n    push(data: AVCCodecData) {\n        const { lastState, lastNALuState } = this;\n        let i = 0,\n            lastNALuOffset = -1,\n            { pts, dts, payload, naluSizeLength } = data;\n\n        if (!naluSizeLength) {\n            // Start parse Annex-B Byte stream format\n            let j = payload.byteLength - 1;\n            let dropZerosLength = 0;\n\n            // Collect tailing zeros.\n            // end with 0x000000 and more...\n            do {\n                if (payload[j] === 0x00) {\n                    dropZerosLength++;\n                } else {\n                    break;\n                }\n\n                j--;\n            } while (j > 0);\n\n            if (dropZerosLength >= 3) {\n                // drop tailing zeros.\n                payload = payload.subarray(0, j + 1);\n            }\n\n            const len = payload.length;\n\n            let state: ParsePesState = 0;\n            do {\n                let value = payload[i++];\n\n                // loop optimization.\n                if (state === 0) {\n                    state = value ? 0 : 1;\n                    continue;\n                } else if (state === 1) {\n                    state = value ? 0 : 2;\n                    continue;\n                }\n\n                // value will be 2 or 3\n                if (!value) {\n                    state = 3;\n                } else if (value === 1) {\n                    if (lastNALuOffset >= 0) {\n                        this.lastNALuState = state;\n                        this.spitNalu_(payload.subarray(lastNALuOffset, i - 1 - state), pts, dts);\n                    } else {\n                        // naluOffset is undefined => this is the first start code found in this PES packet\n                        // first check if start code delimiter is overlapping between 2 PES packets,\n                        // ie it started in last packet (lastState not zero)\n                        // and ended at the beginning of this PES packet (i <= 4 - lastState)\n                        const lastUnit = this.lastNALu;\n                        if (lastUnit) {\n                            if (lastState && i <= 4 - lastState) {\n                                // start delimiter overlapping between PES packets\n                                // strip start delimiter bytes from the end of last NAL unit\n                                // check if lastUnit had a state different from zero\n                                if (lastNALuState) {\n                                    // strip last bytes\n                                    lastUnit.rawData = lastUnit.rawData.subarray(\n                                        0,\n                                        lastUnit.rawData.byteLength - lastState\n                                    );\n                                }\n                            }\n\n                            // If NAL units are not starting right at the\n                            // beginning of the PES packet, push preceding data\n                            // into previous NAL unit.\n                            let overflow = i - state - 1;\n                            if (overflow > 0) {\n                                logger.log(`overflow NALU found: ${overflow}/${pts}/${dts}`);\n                                let cb = new CacheBuffer();\n\n                                cb.append(lastUnit.rawData);\n                                cb.append(payload.subarray(0, overflow));\n                                let bytes = cb.toNewBytes();\n                                cb.clear(); // gc\n\n                                lastUnit.rawData = bytes;\n                            }\n                        }\n                    }\n\n                    // reset state & record last unit start byte offset.\n                    if (i < len) {\n                        // console.log(`'find NALU @ offset: ${i}`);\n                        lastNALuOffset = i;\n                        state = 0;\n                    }\n                } else {\n                    state = 0;\n                }\n            } while (i < len);\n\n            if (lastNALuOffset >= 0 && state >= 0) {\n                this.lastNALuState = state;\n                this.spitNalu_(payload.subarray(lastNALuOffset, len), pts, dts);\n            }\n\n            this.lastState = state;\n        } else {\n            let startPos = 0,\n                size = 0,\n                endPos = 0,\n                byteLength = payload.length;\n            do {\n                size = 0;\n                for (let k = 0; k < naluSizeLength; k++) {\n                    size = size | (payload[startPos + k] << ((naluSizeLength - k - 1) * 8));\n                }\n                // size = (data_byte[i] << 24) | (data_byte[i + 1] << 16) | (data_byte[i + 2] << 8) | data_byte[i + 3];\n                startPos += naluSizeLength;\n                endPos = startPos + size;\n                if (endPos > byteLength) {\n                    endPos = byteLength;\n                }\n\n                this.spitNalu_(payload.subarray(startPos, endPos), pts, dts);\n                startPos = endPos;\n            } while (startPos < byteLength);\n        }\n\n        this.emit('done');\n    }\n\n    reset() {\n        this.lastState = null;\n        this.lastNALu = null;\n        this.lastNALuState = null;\n    }\n}\n","/**\n * @file: avc-config.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport { SPSProps } from './sps';\n// import { PPSProps } from './pps';\n\n/**\n * AVC Config Helper\n * Accord sps/pps, generate mimeType info.\n */\nexport default (sps: SPSProps /*, pps?: PPSProps*/) => {\n    let profile_idc = sps.profile_idc;\n    let profile_compatibility = sps.profile_compatibility;\n    let level_idc = sps.level_idc;\n    let codecString = 'avc1.';\n\n    let arr = [profile_idc, profile_compatibility, level_idc];\n    for (let j = 0; j < arr.length; j++) {\n        let h = arr[j].toString(16);\n        if (h.length < 2) {\n            h = '0' + h;\n        }\n        codecString += h;\n    }\n\n    return {\n        codec: codecString\n    };\n};\n","/**\n * @file: avc.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * H.264/AVC/HEVC Stream.\n */\nimport { AVCCodec, AVCCodecData } from '../../codec/avc';\nimport getAVCConfig from '../../codec/avc/avc-config';\nimport NALU from '../../codec/avc/nalu';\nimport NaluTypes from '../../enum/nalu-types';\nimport { StreamTypes } from '../../enum/stream-types';\nimport logger from '../../util/logger';\nimport Stream from '../../util/stream';\nimport { PSI } from '../psi';\nimport { AVCFrame, GOP, GOPVector, PESStreamEmitData } from '../types/pipeline';\n\nclass H264Stream extends Stream {\n    private PSI: PSI;\n    private trackId?: number;\n    private currentFrame: AVCFrame;\n    private prevFrame: AVCFrame;\n    private codec: AVCCodec;\n    private gop: GOP;\n    private gops: GOPVector;\n\n    constructor(psi: PSI) {\n        super();\n\n        this.PSI = psi;\n        this.trackId = null;\n\n        /** @private {Array} */\n        this.currentFrame = []; // a group of nalu\n\n        /** @private {AVCCodec} */\n        this.codec = new AVCCodec();\n\n        this._newGop();\n        this._newGops();\n\n        this.codec.on('nalu', (nalu: NALU) => {\n            if (nalu.unit_type === NaluTypes.SPS) {\n                let track = this.PSI.findTrack(this.trackId);\n                let config = getAVCConfig(nalu.sps);\n\n                // write sps info to video track.\n                track.codec = config.codec;\n                track.width = nalu.sps.width;\n                track.height = nalu.sps.height;\n                track.profileIdc = nalu.sps.profile_idc;\n                track.profileCompatibility = nalu.sps.profile_compatibility;\n                track.levelIdc = nalu.sps.level_idc;\n                track.pixelRatio = nalu.sps.pixelRatio;\n                track.sps = [nalu.rawData];\n            } else if (nalu.unit_type === NaluTypes.PPS) {\n                let track = this.PSI.findTrack(this.trackId);\n                track.pps = [nalu.rawData];\n            }\n\n            this._grouping(nalu);\n        });\n    }\n\n    /**\n     * Push a complete pes\n     * @param data\n     */\n    push(data: PESStreamEmitData) {\n        const { stream_type, pes, pid } = data;\n        if (stream_type === StreamTypes.H264 || stream_type === StreamTypes.HEVC) {\n            this.trackId = pid;\n\n            let rawData: AVCCodecData = {\n                pts: pes.PTS,\n                dts: pes.DTS,\n                payload: pes.data_byte\n            };\n\n            this.codec.push(rawData);\n        }\n    }\n\n    flush() {\n        // Push last frame into gop.\n        if (this.currentFrame.length > 0) {\n            // If the last frame has valid duration, use the duration of the previous frame\n            if (!this.currentFrame.duration || this.currentFrame.duration <= 0) {\n                this.currentFrame.duration = this.prevFrame.duration || 0;\n            }\n\n            this._pushFrameIntoGop();\n            this.currentFrame = [];\n        }\n\n        // Push last gop.\n        if (this.gop.length > 0) {\n            this._pushGopIntoGroup();\n        }\n    }\n\n    reset() {\n        this.codec.reset();\n\n        this.currentFrame = [];\n        this._newGop();\n        this._newGops();\n    }\n\n    /**\n     * Group nalu into frame & gop.\n     * @param currentNal\n     * @private\n     */\n    _grouping(currentNal) {\n        if (currentNal.unit_type === NaluTypes.AUD) {\n            if (this.currentFrame.length > 0) {\n                this.currentFrame.duration = currentNal.dts - this.currentFrame.dts;\n\n                if (this.gop.length > 0 && this.currentFrame.keyframe) {\n                    this.gop.trackId = this.trackId;\n\n                    this._pushGopIntoGroup();\n                }\n\n                // the gop should commence with a key frame,\n                // or the frame will be dropped until finding one that contains a key frame.\n                if (this.currentFrame.keyframe || this.gop.length > 0) {\n                    this._pushFrameIntoGop();\n                } else {\n                    logger.warn(`h264 codec drop frame`);\n                }\n            }\n\n            this.prevFrame = this.currentFrame;\n\n            // end a frame.\n            this.currentFrame = [];\n            this.currentFrame.keyframe = false;\n            this.currentFrame.byteLength = 0;\n            this.currentFrame.naluCount = 0;\n            this.currentFrame.pts = currentNal.pts;\n            this.currentFrame.dts = currentNal.dts;\n        } else {\n            if (currentNal.unit_type === NaluTypes.IDR_SLICE) {\n                this.currentFrame.keyframe = true;\n            }\n\n            this.currentFrame.byteLength += currentNal.rawData.byteLength;\n            this.currentFrame.naluCount++;\n            this.currentFrame.push(currentNal);\n        }\n\n        this.currentFrame.duration = currentNal.dts - this.currentFrame.dts;\n    }\n\n    _newGop() {\n        this.gop = []; // a group of idr-start-frame sequence\n\n        this.gop.duration = 0;\n        this.gop.naluCount = 0;\n        this.gop.byteLength = 0;\n    }\n\n    _pushFrameIntoGop() {\n        // Gop\n        this.gop.push(this.currentFrame);\n        this.gop.duration += this.currentFrame.duration;\n        this.gop.byteLength += this.currentFrame.byteLength;\n        this.gop.naluCount += this.currentFrame.naluCount;\n    }\n\n    _newGops() {\n        this.gops = []; // a group of gop\n        this.gops.type = 'video';\n        this.gops.duration = 0;\n        this.gops.naluCount = 0;\n        this.gops.byteLength = 0;\n        this.gops.frameLength = 0;\n        this.gops.firstDTS = 0;\n    }\n\n    _pushGopIntoGroup() {\n        let firstFrame = this.gop[0];\n        // GOPs\n        this.gops.trackId = this.trackId;\n        this.gops.duration += this.gop.duration;\n        this.gops.byteLength += this.gop.byteLength;\n        this.gops.naluCount += this.gop.naluCount;\n        this.gops.frameLength += this.gop.length;\n        this.gops.firstDTS = firstFrame.dts;\n        this.gops.firstPTS = firstFrame.pts;\n\n        this.gops.push(this.gop);\n\n        this.emit('data', this.gops);\n\n        this._newGop();\n        this._newGops();\n\n        this.emit('done');\n    }\n}\n\nexport default H264Stream;\n","/**\n * @file: elementary.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Elementary Stream.\n * @summary An elementary stream (ES) as defined by the MPEG communication protocol is usually the output of an audio or video encoder.\n *      ES contains only one kind of data, e.g. audio, video or closed caption.\n * @description  https://en.wikipedia.org/wiki/Elementary_stream\n */\nimport { StreamTypes } from '../../enum/stream-types';\nimport { Context, GlobalOptions } from '../../types/globals';\nimport { isNumber } from '../../util/is';\nimport logger from '../../util/logger';\nimport Stream from '../../util/stream';\nimport { PSI } from '../psi';\nimport { PESStreamEmitData, GOPVector } from '../types/pipeline';\nimport ADTSStream from './adts';\nimport AVCStream from './avc';\n\nclass ElementaryStream extends Stream {\n    private context: Context;\n    private PSI: PSI;\n    private options: GlobalOptions;\n    private tracks: Array<GOPVector>;\n    private adtsStream: ADTSStream;\n    private avcStream: AVCStream;\n    private streams: [ADTSStream, AVCStream];\n\n    constructor(ctx: Context, psi: PSI, options: GlobalOptions = {}) {\n        super();\n\n        this.context = ctx;\n        this.PSI = psi;\n        this.options = options;\n        this.tracks = [];\n        this.adtsStream = new ADTSStream(psi);\n        this.avcStream = new AVCStream(psi);\n        this.streams = [this.adtsStream, this.avcStream];\n\n        if (options.decodeCodec) {\n            this.avcStream.on('data', (data: GOPVector) => {\n                let stubTime = options.config.stubTime;\n\n                if (isNumber(stubTime)) {\n                    let end = (data.firstPTS + data.duration) / 90000;\n                    if (end < stubTime) {\n                        logger.warn(`drop avc gop, start/end/stubTime(${data.firstPTS}/${end}/${stubTime})`);\n                        return;\n                    }\n                }\n\n                this.tracks.push(data);\n                this.emit('data', this.tracks);\n                this.tracks = [];\n                this.adtsStream.flush();\n            });\n\n            this.adtsStream.on('data', (data) => {\n                let stubTime = options.config.stubTime;\n\n                if (isNumber(stubTime)) {\n                    let end = (data.firstPTS + data.duration) / 90000;\n                    if (end < stubTime) {\n                        logger.warn(`drop adts, start/end/stubTime(${data.firstPTS}/${end}/${stubTime})`);\n                        return;\n                    }\n                }\n\n                this.tracks.push(data);\n                this.emit('data', this.tracks);\n                this.tracks = [];\n            });\n        }\n    }\n\n    /**\n     * Push a complete pes\n     * @param data\n     */\n    push(data: PESStreamEmitData): void {\n        const { options, adtsStream, avcStream } = this;\n        let { stream_type } = data;\n\n        if (options.decodeCodec) {\n            switch (stream_type) {\n                case StreamTypes.H264:\n                case StreamTypes.HEVC:\n                    avcStream.push(data);\n                    break;\n                case StreamTypes.ADTS:\n                    adtsStream.push(data);\n                    break;\n                default:\n                    logger.warn(`ts elementary encounter unknown stream type ${stream_type}`);\n            }\n        } else {\n            this.emit('data', data);\n        }\n    }\n\n    flush(): void {\n        let { streams, tracks } = this;\n        for (let i = 0; i < this.streams.length; i++) {\n            let stream = streams[i];\n\n            stream.flush();\n        }\n\n        if (tracks.length > 0) {\n            this.emit('data', tracks);\n        }\n\n        this.emit('done');\n\n        tracks.splice(0, tracks.length);\n    }\n\n    reset(): void {\n        this.tracks = [];\n\n        for (let i = 0; i < this.streams.length; i++) {\n            let stream = this.streams[i];\n\n            stream.reset();\n        }\n\n        this.emit('reset');\n    }\n}\n\nexport default ElementaryStream;\n","/**\n * @file: pes.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Structure for Pes.\n */\nexport class Pes {\n    // private start_code_prefix: number;\n    // stream_id: number;\n    // packet_length: number;\n    // data_alignment_indicator: number;\n    // copyright: number;\n    // ESCR_flag: number;\n    // ES_rate_flag: number;\n    // trick_mode_flag: number;\n    // additional_copy_info_flag: number;\n    // CRC_flag: number;\n    // extension_flag: number;\n    PTS: number;\n    DTS: number;\n    data_byte: Uint8Array;\n\n    constructor(buffer: Uint8Array) {\n        // The packet_start_code_prefix is a 24-bit code.\n        // this.start_code_prefix = (buffer[0] << 16) | (buffer[1] << 8) | buffer[2];\n\n        // In Transport Streams,\n        // the stream_id may be set to any valid value which correctly describes the elementary stream type.\n        // the elementary stream type is specified in the PSI(Program Specific Information).\n        // this.stream_id = buffer[3];\n\n        // A 16-bit field specifying the number of bytes in the PES packet.\n        // this.packet_length = (buffer[4] << 8) | buffer[5];\n\n        // this.data_alignment_indicator = buffer[6] & 0x04;\n\n        // this.copyright = buffer[6] & 0x02;\n\n        // PTS (presentation time stamp)\n        // DTS (decoding time stamp)\n        let PTS_DTS_flags = buffer[7] >> 6;\n\n        // ESCR (Elementary Stream Clock Reference system):\n        // A time stamp in the PES Stream from which decoders of PES streams may derive timing.\n        // this.ESCR_flag = buffer[7] & 0x20;\n\n        // this.ES_rate_flag = buffer[7] & 0x10;\n\n        // this.trick_mode_flag = buffer[7] & 0x08;\n\n        // this.additional_copy_info_flag = buffer[7] & 0x04;\n\n        // this.CRC_flag = buffer[7] & 0x02;\n\n        // this.extension_flag = buffer[7] & 0x01;\n\n        let header_data_length = buffer[8];\n\n        this.PTS = 0;\n        if ((PTS_DTS_flags & 0x02) == 0x02) {\n            this.PTS = this.calcTimestamp_(buffer, 9);\n        }\n\n        // if there is no dts, let DTS=PTS\n        // See Annex D - D.0.2 Audio and Video Presentation Synchronization\n        this.DTS = this.PTS;\n\n        if ((PTS_DTS_flags & 0x01) == 0x01) {\n            this.DTS = this.calcTimestamp_(buffer, 14);\n        }\n\n        // if (this.ESCR_flag === 1) {\n        // }\n        //\n        // if (this.ES_rate_flag === 1) {\n        // }\n        //\n        //\n        // if (this.trick_mode_flag === 1) {\n        //\n        // }\n        //\n        // if (this.ESCR_flag === 1) {\n        // }\n\n        this.data_byte = buffer.subarray(9 + header_data_length);\n\n        // this.isStartPes = (buffer[0] << 16 | buffer[1] << 8 | buffer[2]) & 0xffffff === 0x000001;\n    }\n\n    /**\n     * @param buffer\n     * @param start\n     */\n    private calcTimestamp_(buffer: Uint8Array, start: number): number {\n        // PTS / DTS is 33 bit\n        return (\n            // JS Bitwise operators treat their operands as a sequence of 32 bits,\n            // We cannot use bitwise operator in JS beyond 32bits\n            (buffer[start] & 0x0e) * 536870912 + // Math.pow(2, 29) === 536870912\n            (buffer[start + 1] << 22) +\n            ((buffer[start + 2] >> 1) << 15) +\n            (buffer[start + 3] << 7) +\n            (buffer[start + 4] >> 1)\n        );\n    }\n\n    // valid(): boolean {\n    //     let start_code_prefix = this.start_code_prefix;\n\n    //     return (\n    //         start_code_prefix[0] === 0x00 &&\n    //         start_code_prefix[1] === 0x00 &&\n    //         start_code_prefix[2] === 0x01\n    //     );\n    // }\n}\n","/**\n * @file: pes.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * Packetized Elementary Stream.\n */\nimport { Context } from '../../types/globals';\nimport CacheBuffer from '../../util/cache-buffer';\nimport Stream from '../../util/stream';\nimport { PSI } from '../psi';\nimport { Packet } from '../structs/packet';\nimport { Pes } from '../structs/pes';\nimport { PESStreamEmitData } from '../types/pipeline';\n\nclass PesStream extends Stream {\n    private context: Context;\n    private PSI: PSI;\n    private PID?: number;\n    private cache_buffer: CacheBuffer;\n\n    constructor(ctx: Context, psi: PSI) {\n        super();\n\n        this.context = ctx;\n        this.PSI = psi;\n        this.PID = null;\n        this.cache_buffer = new CacheBuffer();\n    }\n\n    /**\n     * @param packet\n     */\n    push(packet: Packet) {\n        const self = this;\n\n        // PES PID\n        // 0x20 - 0xff is reserved for dvb etc. (https://en.wikipedia.org/wiki/Program-specific_information#PSI_labels)\n        // but this is not strict restriction.\n        if (packet.PID > 0x001f && packet.PID < 0x1fff) {\n            if (this.PSI.currentProgramPID == -1) {\n                self._pushPacket(packet);\n            } else if (this.PSI.currentProgramPID !== packet.PID) {\n                if (packet.payload_unit_start_indicator === 1) {\n                    self._assembleOnePES();\n                }\n\n                self._pushPacket(packet);\n            }\n        }\n    }\n\n    flush() {\n        const self = this;\n\n        // 组装最后一个PES\n        self._assembleOnePES();\n\n        self.emit('done');\n    }\n\n    reset() {\n        this._clearCached();\n\n        this.emit('reset');\n    }\n\n    _clearCached() {\n        this.PID = null;\n        this.cache_buffer.clear();\n    }\n\n    _pushPacket(p) {\n        let empty = this.cache_buffer.empty;\n\n        // Make first packet in cache is start unit.\n        if (empty && p.payload_unit_start_indicator === 0) {\n            return;\n        }\n\n        if (empty) {\n            this.PID = p.PID;\n        }\n\n        this.cache_buffer.append(p.payload);\n    }\n\n    _assembleOnePES() {\n        const self = this;\n\n        if (!this.cache_buffer.empty) {\n            let bytes;\n\n            try {\n                bytes = this.cache_buffer.toNewBytes();\n            } catch (e) {\n                throw `pes alloc mem err ${this.cache_buffer.byteLength}`;\n            }\n\n            let pesData = new Pes(bytes);\n            let track = this.PSI.findTrack(this.PID);\n\n            // console.log(`stream_id: ${pesData.stream_id}, PTS: ${pesData.PTS}, DTS: ${pesData.DTS}`);\n\n            if (track) {\n                let data: PESStreamEmitData = {\n                    pid: track.id,\n                    stream_type: track.stream_type,\n                    // pcr_pid: track.pcr_pid,\n                    pes: pesData\n                };\n                // Assemble one pes packet, emit it to next stream.\n                self.emit('data', data);\n            }\n\n            self._clearCached();\n        }\n    }\n}\n\nexport default PesStream;\n","/**\n * @file: packet.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nconst SYNC_BYTE = 0x47; // The sync_byte is a fixed 8-bit field whose value is '0100 0111' (0x47).\n\n/**\n * packet structure.\n */\nexport class Packet {\n    sync_byte: number;\n    // transport_error_indicator: number;\n    payload_unit_start_indicator: number;\n    // transport_priority: number;\n    PID: number;\n    // tsc: number;\n    afc: number;\n    // continuity_counter: number;\n    has_payload: number;\n    has_adaptation: number;\n    // is_discontinuity: boolean;\n    payload: Uint8Array;\n\n    /**\n     * @param buffer\n     */\n    constructor(buffer: Uint8Array) {\n        this.sync_byte = buffer[0];\n\n        // this.transport_error_indicator = buffer[1] >> 7;\n\n        // Indicating transport stream packets carry PES packets or PSI data\n        // PES: 1 -> commence with the first byte of a PES packet,  0 -> no PES packet shall start in this packet.\n        // PSI: 1 -> carries the first byte of a PSI section, 0 -> no pointer_field in the payload.\n        this.payload_unit_start_indicator = (buffer[1] >> 6) & 1;\n\n        // this.transport_priority = (buffer[1] >>> 5) & 1;\n\n        // The PID(Packet ID) is a 13-bit field, indicating the type of the data stored in the packet payload.\n        // NOTE – The transport packets with PID values 0x0000, 0x0001, and 0x0010-0x1FFE are allowed to carry a PCR.\n        // ISO/IEC 13818-1 : 2000 (E)\n        // Value                  Description\n        // 0x0000                 Program Association Table\n        // 0x0001                 Conditional Access Table\n        // 0x0002                 Transport Stream Description Table\n        // 0x0003-0x000F          Reserved\n        // 0x0010 ... 0x1FFE      May be assigned as network_PID, Program_map_PID, elementary_PID, or for other purposes\n        // https://www.dvb.org/resources/public/standards/a38_dvb-si_specification.pdf\n        // 0x0040                 Network_information_section-actual_network\n        // 0x0041                 Network_information_section-other_network\n        // 0x0042                 Service_description_section-actual_transport_stream\n        // 0x0043                 TO 0x45 Reserved for future use\n        // 0x0046                 Service_description_section-other_transport_stream\n        // 0x0047                 TO 0x49 Reserved for future use\n        // 0x004A                 Bouquet_association_section\n        // 0x004B                 TO 0x4D Reserved for future use\n        // 0x004E                 Event_information_section-actual_transport_stream,P/F\n        // 0x004F                 Event_information_section-other_transport_stream,P/F\n        // 0x0050                 TO 0x5F Event_information_section-actual_transport_stream,schedule\n        // 0x0060                 TO 0x6F Event_information_section-other_transport_stream,schedule\n        // 0x0070                 Time_data_section\n        // 0x0071                 Running_status_section\n        // 0x0072                 Stuffing_section\n        // 0x0073                 Time_offset_section\n        // 0x0074                 TO 0x007D Reserved for future use\n        // 0x007E                 Discontinuity_information_section\n        // 0x007F                 Selection_information_section\n        // 0x0080                 TO 0x00FE User defined\n        // 0x00FF                 Reserved\n        // 0x1FFF                 Null packet\n        this.PID = ((buffer[1] << 8) | buffer[2]) & 0x1fff;\n\n        // transport_scrambling_control\n        // this.tsc = buffer[3] >> 6;\n\n        // adaptation_field_control\n        // Value  Description\n        // 00     Reserved for future use by ISO/IEC\n        // 01     No adaptation_field, payload only\n        // 10     Adaptation_field only, no payload\n        // 11     Adaptation_field followed by payload\n        this.afc = (buffer[3] >> 4) & 3;\n\n        // '1' indicates that the discontinuity state is true for the current Transport Stream packet.\n        // this.continuity_counter = buffer[3] & 0xf;\n\n        // self defines.\n        this.has_payload = this.afc & 1;\n        this.has_adaptation = this.afc & 2;\n        // this.is_discontinuity = this.has_adaptation && buffer[4] != 0 /* with length > 0 */ && buffer[5] & 0x80;\n        /* and discontinuity indicated */\n\n        if (this.has_payload) {\n            if (this.has_adaptation) {\n                let adaptation_field_length = buffer[4];\n                this.payload = buffer.subarray(5 + adaptation_field_length);\n            } else {\n                this.payload = buffer.subarray(4);\n            }\n        }\n    }\n\n    valid() {\n        return this.sync_byte === SYNC_BYTE && this.has_payload === 1;\n    }\n}\n","/**\n * @file: demux.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * MPEG-2 transport stream demuxer.\n */\nimport DemuxFacade from '../demux-facade';\nimport muxErrorCode from '../mux-error-code';\nimport { GlobalOptions, PushConf } from '../types/globals';\nimport logger from '../util/logger';\nimport { PSI } from './psi';\nimport M2TSComplexStream from './streams/complex';\nimport ElementaryStream from './streams/elementary';\nimport PesStream from './streams/pes';\nimport { Packet } from './structs/packet';\n\nconst CHUNK_BYTE_LENGTH = 188; // Transport Stream chunks shall be 188 bytes long.\n\ntype InterfaceStream = M2TSComplexStream | ElementaryStream;\n\nexport class TSDemux extends DemuxFacade {\n    private psi_: PSI;\n    private pesStream_: PesStream;\n    private elementaryStream_: ElementaryStream;\n    private complexStream_: M2TSComplexStream;\n\n    constructor(options: GlobalOptions = {}) {\n        super(options);\n\n        this.psi_ = new PSI(this.ctx_);\n        this.pesStream_ = new PesStream(this.ctx_, this.psi_);\n        this.elementaryStream_ = new ElementaryStream(this.ctx_, this.psi_, options);\n        this.complexStream_ = new M2TSComplexStream(this.ctx_, this.psi_);\n\n        // Compose pipeline\n        this.pipe(this.pesStream_);\n        this.pesStream_.pipe(this.elementaryStream_);\n        this.elementaryStream_.pipe(this.complexStream_);\n\n        super.listenEndStream_();\n    }\n\n    /**\n     * This is end pipeline stream\n     */\n    get endStream(): InterfaceStream {\n        let stream: InterfaceStream = this.elementaryStream_;\n\n        if (this.options_.decodeCodec) {\n            stream = this.complexStream_;\n        }\n\n        return stream;\n    }\n\n    /**\n     * TS push support streaming incomplete data push.\n     * @param buffer\n     * @param conf\n     * @param conf.done - If you need the done event, this boolean needs to be set\n     */\n    push(buffer: ArrayBuffer | Uint8Array, conf: PushConf) {\n        const { done } = conf;\n        const { options_, ctx_, cache_buffer_, psi_ } = this;\n        let newBuf: Uint8Array = super.constraintPushData_(buffer);\n        let cacheByteLength = cache_buffer_.byteLength;\n        let byteOffset = null;\n\n        options_.config = conf;\n\n        logger.log(\n            `hls demux received ${newBuf.byteLength} bytes, cache ${cacheByteLength} bytes. ${done ? 'chunk done' : ''}`\n        );\n\n        cache_buffer_.append(newBuf);\n\n        while (cache_buffer_.byteLength >= CHUNK_BYTE_LENGTH) {\n            let chunk = cache_buffer_.cut(CHUNK_BYTE_LENGTH);\n\n            // The pushed buffer may be so small that can't cut a ts chunk.\n            if (chunk) {\n                let packet = new Packet(chunk);\n\n                if (packet.valid()) {\n                    psi_.parse(packet);\n\n                    this.emit('data', packet);\n                } else {\n                    let errMsg = `Encounter invalid ts packet, packet_length(${chunk.length}), cache_length(${this.cache_buffer_.byteLength}), has_payload(${packet.has_payload}), data(${chunk})`;\n\n                    logger.error(errMsg);\n\n                    this.reset();\n\n                    ctx_.emit('error', muxErrorCode.TS_SYNC_BYTE, errMsg, {\n                        startByte: byteOffset,\n                        endByte: byteOffset + chunk.byteLength\n                    });\n                    break;\n                }\n\n                byteOffset += chunk.byteLength;\n            }\n        }\n\n        if (cache_buffer_.empty && done) {\n            // logger.log('mux packet done!');\n            this.emit('done');\n        }\n    }\n\n    reset() {\n        this.cache_buffer_.clear();\n\n        this.emit('reset');\n    }\n}\n","/**\n * @file: mp4-inspector.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/* eslint-disable */\nlet /**\n     * Returns the string representation of an ASCII encoded four byte buffer.\n     * @param buffer - a four-byte buffer to translate\n     * @return the corresponding string\n     */\n    parseType = function (buffer: Uint8Array): string {\n        let result = '';\n        result += String.fromCharCode(buffer[0]);\n        result += String.fromCharCode(buffer[1]);\n        result += String.fromCharCode(buffer[2]);\n        result += String.fromCharCode(buffer[3]);\n        return result;\n    },\n    parseMp4Date = function (seconds: number): Date {\n        return new Date(seconds * 1000 - 2082844800000);\n    },\n    parseSampleFlags = function (flags: Uint8Array) {\n        return {\n            isLeading: (flags[0] & 0x0c) >>> 2,\n            dependsOn: flags[0] & 0x03,\n            isDependedOn: (flags[1] & 0xc0) >>> 6,\n            hasRedundancy: (flags[1] & 0x30) >>> 4,\n            paddingValue: (flags[1] & 0x0e) >>> 1,\n            isNonSyncSample: flags[1] & 0x01,\n            degradationPriority: (flags[2] << 8) | flags[3]\n        };\n    },\n    nalParse = function (avcStream) {\n        let avcView = new DataView(avcStream.buffer, avcStream.byteOffset, avcStream.byteLength),\n            result = [],\n            i,\n            length;\n        for (i = 0; i < avcStream.length; i += length) {\n            length = avcView.getUint32(i);\n            i += 4;\n            switch (avcStream[i] & 0x1f) {\n                case 0x01:\n                    result.push('NDR');\n                    break;\n                case 0x05:\n                    result.push('IDR');\n                    break;\n                case 0x06:\n                    result.push('SEI');\n                    break;\n                case 0x07:\n                    result.push('SPS');\n                    break;\n                case 0x08:\n                    result.push('PPS');\n                    break;\n                case 0x09:\n                    result.push('AUD');\n                    break;\n                default:\n                    result.push(avcStream[i] & 0x1f);\n                    break;\n            }\n        }\n        return result;\n    },\n    // registry of handlers for individual mp4 box types\n    parse = {\n        // codingname, not a first-class box type. stsd entries share the\n        // same format as real boxes so the parsing infrastructure can be\n        // shared\n        avc1: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n            return {\n                dataReferenceIndex: view.getUint16(6),\n                width: view.getUint16(24),\n                height: view.getUint16(26),\n                horizresolution: view.getUint16(28) + view.getUint16(30) / 16,\n                vertresolution: view.getUint16(32) + view.getUint16(34) / 16,\n                frameCount: view.getUint16(40),\n                depth: view.getUint16(74),\n                config: mp4toJSON(data.subarray(78, data.byteLength))\n            };\n        },\n        avcC: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n                result = {\n                    configurationVersion: data[0],\n                    avcProfileIndication: data[1],\n                    profileCompatibility: data[2],\n                    avcLevelIndication: data[3],\n                    lengthSizeMinusOne: data[4] & 0x03,\n                    sps: [],\n                    pps: []\n                },\n                numOfSequenceParameterSets = data[5] & 0x1f,\n                numOfPictureParameterSets,\n                nalSize,\n                offset,\n                i;\n\n            // iterate past any SPSs\n            offset = 6;\n            for (i = 0; i < numOfSequenceParameterSets; i++) {\n                nalSize = view.getUint16(offset);\n                offset += 2;\n                result.sps.push(new Uint8Array(data.subarray(offset, offset + nalSize)));\n                offset += nalSize;\n            }\n            // iterate past any PPSs\n            numOfPictureParameterSets = data[offset];\n            offset++;\n            for (i = 0; i < numOfPictureParameterSets; i++) {\n                nalSize = view.getUint16(offset);\n                offset += 2;\n                result.pps.push(new Uint8Array(data.subarray(offset, offset + nalSize)));\n                offset += nalSize;\n            }\n            return result;\n        },\n        btrt: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n            return {\n                bufferSizeDB: view.getUint32(0),\n                maxBitrate: view.getUint32(4),\n                avgBitrate: view.getUint32(8)\n            };\n        },\n        esds: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n            return {\n                version: data[0],\n                flags: new Uint8Array(data.subarray(1, 4)),\n                esId: (data[6] << 8) | data[7],\n                streamPriority: data[8] & 0x1f,\n                decoderConfig: {\n                    objectProfileIndication: data[11],\n                    streamType: (data[12] >>> 2) & 0x3f,\n                    bufferSize: (data[13] << 16) | (data[14] << 8) | data[15],\n                    maxBitrate: (data[16] << 24) | (data[17] << 16) | (data[18] << 8) | data[19],\n                    avgBitrate: (data[20] << 24) | (data[21] << 16) | (data[22] << 8) | data[23],\n                    decoderConfigDescriptor: {\n                        tag: data[24],\n                        length: data[25],\n                        // audioObjectType: (data[26] >>> 3) & 0x1f,\n                        // samplingFrequencyIndex: ((data[26] & 0x07) << 1) |\n                        //   ((data[27] >>> 7) & 0x01),\n                        // channelConfiguration: (data[27] >>> 3) & 0x0f,\n                        // FIXME\n                        audioObjectType: (data[35] >>> 3) & 0x1f,\n                        samplingFrequencyIndex: ((data[35] & 0x07) << (8 + (data[36] & 0x80))) >> 7,\n                        channelConfiguration: (data[36] & 0x78) >> 3\n                    }\n                }\n            };\n        },\n        ftyp: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n                result = {\n                    majorBrand: parseType(data.subarray(0, 4)),\n                    minorVersion: view.getUint32(4),\n                    compatibleBrands: []\n                },\n                i = 8;\n            while (i < data.byteLength) {\n                result.compatibleBrands.push(parseType(data.subarray(i, i + 4)));\n                i += 4;\n            }\n            return result;\n        },\n        dinf: function (data) {\n            return {\n                boxes: mp4toJSON(data)\n            };\n        },\n        dref: function (data) {\n            return {\n                version: data[0],\n                flags: new Uint8Array(data.subarray(1, 4)),\n                dataReferences: mp4toJSON(data.subarray(8))\n            };\n        },\n        hdlr: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n                result = {\n                    version: view.getUint8(0),\n                    flags: new Uint8Array(data.subarray(1, 4)),\n                    handlerType: parseType(data.subarray(8, 12)),\n                    name: ''\n                },\n                i = 8;\n\n            // parse out the name field\n            for (i = 24; i < data.byteLength; i++) {\n                if (data[i] === 0x00) {\n                    // the name field is null-terminated\n                    i++;\n                    break;\n                }\n                result.name += String.fromCharCode(data[i]);\n            }\n            // decode UTF-8 to javascript's internal representation\n            // see http://ecmanaut.blogspot.com/2006/07/encoding-decoding-utf8-in-javascript.html\n            result.name = decodeURIComponent(decodeURIComponent(result.name));\n\n            return result;\n        },\n        // mdat: function(data) {\n        // \treturn {\n        // \t\tbyteLength: data.byteLength,\n        // \t\tnals: nalParse(data),\n        // \t\trealData: data\n        // \t};\n        // },\n        mdhd: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n                i = 4,\n                language,\n                result = {\n                    version: view.getUint8(0),\n                    flags: new Uint8Array(data.subarray(1, 4)),\n                    language: '',\n                    creationTime: new Date(),\n                    modificationTime: new Date(),\n                    timescale: 0,\n                    duration: 0\n                };\n            if (result.version === 1) {\n                i += 4;\n                result.creationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n                i += 8;\n                result.modificationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n                i += 4;\n                result.timescale = view.getUint32(i);\n                i += 8;\n                result.duration = view.getUint32(i); // truncating top 4 bytes\n            } else {\n                result.creationTime = parseMp4Date(view.getUint32(i));\n                i += 4;\n                result.modificationTime = parseMp4Date(view.getUint32(i));\n                i += 4;\n                result.timescale = view.getUint32(i);\n                i += 4;\n                result.duration = view.getUint32(i);\n            }\n            i += 4;\n            // language is stored as an ISO-639-2/T code in an array of three 5-bit fields\n            // each field is the packed difference between its ASCII value and 0x60\n            language = view.getUint16(i);\n            result.language += String.fromCharCode((language >> 10) + 0x60);\n            result.language += String.fromCharCode(((language & 0x03c0) >> 5) + 0x60);\n            result.language += String.fromCharCode((language & 0x1f) + 0x60);\n\n            return result;\n        },\n        mdia: function (data) {\n            return {\n                boxes: mp4toJSON(data)\n            };\n        },\n        mfhd: function (data) {\n            return {\n                version: data[0],\n                flags: new Uint8Array(data.subarray(1, 4)),\n                sequenceNumber: (data[4] << 24) | (data[5] << 16) | (data[6] << 8) | data[7]\n            };\n        },\n        minf: function (data) {\n            return {\n                boxes: mp4toJSON(data)\n            };\n        },\n        // codingname, not a first-class box type. stsd entries share the\n        // same format as real boxes so the parsing infrastructure can be\n        // shared\n        mp4a: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n                result = {\n                    // 6 bytes reserved\n                    dataReferenceIndex: view.getUint16(6),\n                    // 4 + 4 bytes reserved\n                    channelcount: view.getUint16(16),\n                    samplesize: view.getUint16(18),\n                    // 2 bytes pre_defined\n                    // 2 bytes reserved\n                    samplerate: view.getUint16(24) + view.getUint16(26) / 65536,\n                    streamDescriptor: undefined\n                };\n\n            // if there are more bytes to process, assume this is an ISO/IEC\n            // 14496-14 MP4AudioSampleEntry and parse the ESDBox\n            if (data.byteLength > 28) {\n                result.streamDescriptor = mp4toJSON(data.subarray(28))[0];\n            }\n            return result;\n        },\n        moof: function (data) {\n            return {\n                boxes: mp4toJSON(data)\n            };\n        },\n        moov: function (data) {\n            return {\n                boxes: mp4toJSON(data)\n            };\n        },\n        mvex: function (data) {\n            return {\n                boxes: mp4toJSON(data)\n            };\n        },\n        mvhd: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n                i = 4,\n                result = {\n                    version: view.getUint8(0),\n                    flags: new Uint8Array(data.subarray(1, 4)),\n                    creationTime: new Date(),\n                    modificationTime: new Date(),\n                    timescale: 0,\n                    duration: 0,\n                    rate: 0,\n                    volume: 0,\n                    matrix: new Uint32Array(0),\n                    nextTrackId: 0\n                };\n\n            if (result.version === 1) {\n                i += 4;\n                result.creationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n                i += 8;\n                result.modificationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n                i += 4;\n                result.timescale = view.getUint32(i);\n                i += 8;\n                result.duration = view.getUint32(i); // truncating top 4 bytes\n            } else {\n                result.creationTime = parseMp4Date(view.getUint32(i));\n                i += 4;\n                result.modificationTime = parseMp4Date(view.getUint32(i));\n                i += 4;\n                result.timescale = view.getUint32(i);\n                i += 4;\n                result.duration = view.getUint32(i);\n            }\n            i += 4;\n\n            // convert fixed-point, base 16 back to a number\n            result.rate = view.getUint16(i) + view.getUint16(i + 2) / 16;\n            i += 4;\n            result.volume = view.getUint8(i) + view.getUint8(i + 1) / 8;\n            i += 2;\n            i += 2;\n            i += 2 * 4;\n            result.matrix = new Uint32Array(data.subarray(i, i + 9 * 4));\n            i += 9 * 4;\n            i += 6 * 4;\n            result.nextTrackId = view.getUint32(i);\n            return result;\n        },\n        pdin: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n            return {\n                version: view.getUint8(0),\n                flags: new Uint8Array(data.subarray(1, 4)),\n                rate: view.getUint32(4),\n                initialDelay: view.getUint32(8)\n            };\n        },\n        sdtp: function (data) {\n            let result = {\n                    version: data[0],\n                    flags: new Uint8Array(data.subarray(1, 4)),\n                    samples: []\n                },\n                i;\n\n            for (i = 4; i < data.byteLength; i++) {\n                result.samples.push({\n                    dependsOn: (data[i] & 0x30) >> 4,\n                    isDependedOn: (data[i] & 0x0c) >> 2,\n                    hasRedundancy: data[i] & 0x03\n                });\n            }\n            return result;\n        },\n        sidx: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n                result = {\n                    version: data[0],\n                    flags: new Uint8Array(data.subarray(1, 4)),\n                    references: [],\n                    referenceId: view.getUint32(4),\n                    timescale: view.getUint32(8),\n                    earliestPresentationTime: view.getUint32(12),\n                    firstOffset: view.getUint32(16)\n                },\n                referenceCount = view.getUint16(22),\n                i;\n\n            for (i = 24; referenceCount; i += 12, referenceCount--) {\n                result.references.push({\n                    referenceType: (data[i] & 0x80) >>> 7,\n                    referencedSize: view.getUint32(i) & 0x7fffffff,\n                    subsegmentDuration: view.getUint32(i + 4),\n                    startsWithSap: !!(data[i + 8] & 0x80),\n                    sapType: (data[i + 8] & 0x70) >>> 4,\n                    sapDeltaTime: view.getUint32(i + 8) & 0x0fffffff\n                });\n            }\n\n            return result;\n        },\n        stbl: function (data) {\n            return {\n                boxes: mp4toJSON(data)\n            };\n        },\n        stco: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n            let entryCount = view.getUint32(4);\n            let result = {\n                version: data[0],\n                flags: new Uint8Array(data.subarray(1, 4)),\n                entryCount: entryCount,\n                chunkOffsets: []\n            };\n            for (let i = 8; entryCount; i += 4, entryCount--) {\n                result.chunkOffsets.push(view.getUint32(i));\n            }\n            return result;\n        },\n        stsc: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n                entryCount = view.getUint32(4),\n                result = {\n                    version: data[0],\n                    flags: new Uint8Array(data.subarray(1, 4)),\n                    sampleToChunks: []\n                },\n                i;\n            for (i = 8; entryCount; i += 12, entryCount--) {\n                result.sampleToChunks.push({\n                    firstChunk: view.getUint32(i),\n                    samplesPerChunk: view.getUint32(i + 4),\n                    sampleDescriptionIndex: view.getUint32(i + 8)\n                });\n            }\n            return result;\n        },\n        stsd: function (data) {\n            return {\n                version: data[0],\n                flags: new Uint8Array(data.subarray(1, 4)),\n                boxes: mp4toJSON(data.subarray(8))\n            };\n        },\n        stsz: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n                result = {\n                    version: data[0],\n                    flags: new Uint8Array(data.subarray(1, 4)),\n                    sampleSize: view.getUint32(4),\n                    entries: []\n                },\n                i;\n            for (i = 12; i < data.byteLength; i += 4) {\n                result.entries.push(view.getUint32(i));\n            }\n            return result;\n        },\n        stts: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n                result = {\n                    version: data[0],\n                    flags: new Uint8Array(data.subarray(1, 4)),\n                    timeToSamples: []\n                },\n                entryCount = view.getUint32(4),\n                i;\n\n            for (i = 8; entryCount; i += 8, entryCount--) {\n                result.timeToSamples.push({\n                    sampleCount: view.getUint32(i),\n                    sampleDelta: view.getUint32(i + 4)\n                });\n            }\n            return result;\n        },\n        styp: function (data) {\n            return parse.ftyp(data);\n        },\n        tfdt: function (data) {\n            return {\n                version: data[0],\n                flags: new Uint8Array(data.subarray(1, 4)),\n                baseMediaDecodeTime: (data[4] << 24) | (data[5] << 16) | (data[6] << 8) | data[7]\n            };\n        },\n        tfhd: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n                result: {\n                    version: number;\n                    flags: Uint8Array;\n                    trackId: number;\n                    baseDataOffset?: number;\n                    sampleDescriptionIndex?: number;\n                    defaultSampleDuration?: number;\n                    defaultSampleSize?: number;\n                    defaultSampleFlags?: number;\n                } = {\n                    version: data[0],\n                    flags: new Uint8Array(data.subarray(1, 4)),\n                    trackId: view.getUint32(4)\n                },\n                baseDataOffsetPresent = result.flags[2] & 0x01,\n                sampleDescriptionIndexPresent = result.flags[2] & 0x02,\n                defaultSampleDurationPresent = result.flags[2] & 0x08,\n                defaultSampleSizePresent = result.flags[2] & 0x10,\n                defaultSampleFlagsPresent = result.flags[2] & 0x20,\n                i;\n\n            i = 8;\n            if (baseDataOffsetPresent) {\n                i += 4; // truncate top 4 bytes\n                result.baseDataOffset = view.getUint32(12);\n                i += 4;\n            }\n            if (sampleDescriptionIndexPresent) {\n                result.sampleDescriptionIndex = view.getUint32(i);\n                i += 4;\n            }\n            if (defaultSampleDurationPresent) {\n                result.defaultSampleDuration = view.getUint32(i);\n                i += 4;\n            }\n            if (defaultSampleSizePresent) {\n                result.defaultSampleSize = view.getUint32(i);\n                i += 4;\n            }\n            if (defaultSampleFlagsPresent) {\n                result.defaultSampleFlags = view.getUint32(i);\n            }\n            return result;\n        },\n        tkhd: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n                i = 4,\n                result = {\n                    version: view.getUint8(0),\n                    flags: new Uint8Array(data.subarray(1, 4)),\n                    creationTime: new Date(),\n                    modificationTime: new Date(),\n                    trackId: 0,\n                    duration: 0,\n                    layer: 0,\n                    alternateGroup: 0,\n                    volume: 0,\n                    width: 0,\n                    height: 0,\n                    matrix: new Uint32Array(0)\n                };\n            if (result.version === 1) {\n                i += 4;\n                result.creationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n                i += 8;\n                result.modificationTime = parseMp4Date(view.getUint32(i)); // truncating top 4 bytes\n                i += 4;\n                result.trackId = view.getUint32(i);\n                i += 4;\n                i += 8;\n                result.duration = view.getUint32(i); // truncating top 4 bytes\n            } else {\n                result.creationTime = parseMp4Date(view.getUint32(i));\n                i += 4;\n                result.modificationTime = parseMp4Date(view.getUint32(i));\n                i += 4;\n                result.trackId = view.getUint32(i);\n                i += 4;\n                i += 4;\n                result.duration = view.getUint32(i);\n            }\n            i += 4;\n            i += 2 * 4;\n            result.layer = view.getUint16(i);\n            i += 2;\n            result.alternateGroup = view.getUint16(i);\n            i += 2;\n            // convert fixed-point, base 16 back to a number\n            result.volume = view.getUint8(i) + view.getUint8(i + 1) / 8;\n            i += 2;\n            i += 2;\n            result.matrix = new Uint32Array(data.subarray(i, i + 9 * 4));\n            i += 9 * 4;\n            result.width = view.getUint16(i) + view.getUint16(i + 2) / 16;\n            i += 4;\n            result.height = view.getUint16(i) + view.getUint16(i + 2) / 16;\n            return result;\n        },\n        traf: function (data) {\n            return {\n                boxes: mp4toJSON(data)\n            };\n        },\n        trak: function (data) {\n            return {\n                boxes: mp4toJSON(data)\n            };\n        },\n        trex: function (data) {\n            let view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n            return {\n                version: data[0],\n                flags: new Uint8Array(data.subarray(1, 4)),\n                trackId: view.getUint32(4),\n                defaultSampleDescriptionIndex: view.getUint32(8),\n                defaultSampleDuration: view.getUint32(12),\n                defaultSampleSize: view.getUint32(16),\n                sampleDependsOn: data[20] & 0x03,\n                sampleIsDependedOn: (data[21] & 0xc0) >> 6,\n                sampleHasRedundancy: (data[21] & 0x30) >> 4,\n                samplePaddingValue: (data[21] & 0x0e) >> 1,\n                sampleIsDifferenceSample: !!(data[21] & 0x01),\n                sampleDegradationPriority: view.getUint16(22)\n            };\n        },\n        trun: function (data) {\n            let result: {\n                    version: number;\n                    flags: Uint8Array;\n                    samples: Array<any>;\n                    dataOffset?: number;\n                } = {\n                    version: data[0],\n                    flags: new Uint8Array(data.subarray(1, 4)),\n                    samples: []\n                },\n                view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n                dataOffsetPresent = result.flags[2] & 0x01,\n                firstSampleFlagsPresent = result.flags[2] & 0x04,\n                sampleDurationPresent = result.flags[1] & 0x01,\n                sampleSizePresent = result.flags[1] & 0x02,\n                sampleFlagsPresent = result.flags[1] & 0x04,\n                sampleCompositionTimeOffsetPresent = result.flags[1] & 0x08,\n                sampleCount = view.getUint32(4),\n                offset = 8,\n                sample;\n\n            if (dataOffsetPresent) {\n                result.dataOffset = view.getUint32(offset);\n                offset += 4;\n            }\n            if (firstSampleFlagsPresent && sampleCount) {\n                sample = {\n                    flags: parseSampleFlags(data.subarray(offset, offset + 4))\n                };\n                offset += 4;\n                if (sampleDurationPresent) {\n                    sample.duration = view.getUint32(offset);\n                    offset += 4;\n                }\n                if (sampleSizePresent) {\n                    sample.size = view.getUint32(offset);\n                    offset += 4;\n                }\n                if (sampleCompositionTimeOffsetPresent) {\n                    sample.compositionTimeOffset = view.getUint32(offset);\n                    offset += 4;\n                }\n                result.samples.push(sample);\n                sampleCount--;\n            }\n            while (sampleCount--) {\n                sample = {};\n                if (sampleDurationPresent) {\n                    sample.duration = view.getUint32(offset);\n                    offset += 4;\n                }\n                if (sampleSizePresent) {\n                    sample.size = view.getUint32(offset);\n                    offset += 4;\n                }\n                if (sampleFlagsPresent) {\n                    sample.flags = parseSampleFlags(data.subarray(offset, offset + 4));\n                    offset += 4;\n                }\n                if (sampleCompositionTimeOffsetPresent) {\n                    sample.compositionTimeOffset = view.getUint32(offset);\n                    offset += 4;\n                }\n                result.samples.push(sample);\n            }\n            return result;\n        },\n        'url ': function (data) {\n            return {\n                version: data[0],\n                flags: new Uint8Array(data.subarray(1, 4))\n            };\n        },\n        vmhd: function (data) {\n            //let view = new DataView(data.buffer, data.byteOffset, data.byteLength);\n            return {\n                version: data[0],\n                flags: new Uint8Array(data.subarray(1, 4))\n                //graphicsmode: view.getUint16(4),\n                //opcolor: new Uint16Array([view.getUint16(6),\n                //                          view.getUint16(8),\n                //                          view.getUint16(10)])\n            };\n        }\n    };\n\n/**\n * Return a javascript array of box objects parsed from an ISO base media file.\n * @param data - the binary data of the media to be inspected\n * @return a javascript array of potentially nested box objects\n */\nlet mp4toJSON = function (data: Uint8Array): Array<any> {\n    let i = 0,\n        result = [],\n        view = new DataView(data.buffer, data.byteOffset, data.byteLength),\n        size,\n        type,\n        end,\n        box;\n\n    while (i < data.byteLength) {\n        // parse box data\n        (size = view.getUint32(i)), (type = parseType(data.subarray(i + 4, i + 8)));\n        end = size > 1 ? i + size : data.byteLength;\n\n        // parse type-specific data\n        box = (\n            parse[type] ||\n            function (data) {\n                return {\n                    data: data\n                };\n            }\n        )(data.subarray(i + 8, end));\n        box.size = size;\n        box.type = type;\n\n        // store this box and move to the next\n        result.push(box);\n        i = end;\n    }\n    return result;\n};\n\nexport const MP4Inspect = {\n    mp4toJSON: mp4toJSON\n};\n","/**\n * @file: demux.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport DemuxFacade from '../demux-facade';\nimport { GlobalOptions } from '../types/globals';\nimport logger from '../util/logger';\nimport { MP4Inspect } from './mp4-inspector';\n\n/**\n * mp4.\n */\nexport class MP4Demux extends DemuxFacade {\n    constructor(options: GlobalOptions = {}) {\n        super(options);\n\n        super.listenEndStream_();\n    }\n\n    /**\n     * This is end pipeline stream\n     */\n    get endStream() {\n        return this;\n    }\n\n    /**\n     * The MP4 data pushed into stream should be complete data.\n     * @param buffer\n     */\n    push(buffer: ArrayBuffer | Uint8Array) {\n        let newBuf: Uint8Array = super.constraintPushData_(buffer);\n\n        logger.log(`mp4 demux received ${newBuf.byteLength} bytes`);\n\n        let result = MP4Inspect.mp4toJSON(newBuf);\n\n        this.emit('data', result);\n    }\n}\n","/**\n * @file: created at Wednesday, 13th May 2020 4:15:40 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nexport const HEAD_LEN = 9;\nexport const MIN_BODY_LEN = 4;\nexport const PREVIOUS_TAG_SIZE = 4;\nexport const MIN_TAG_LEN = PREVIOUS_TAG_SIZE;\n\nexport enum FLVParseStage {\n    HEAD = 0,\n    BODY\n}\n","/**\n * @file: created at Saturday, 23rd May 2020 11:46:18 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nenum FlvTagTypes {\n    SCRIPT_DATA = 18,\n    VIDEO = 9,\n    AUDIO = 8\n}\n\nexport default FlvTagTypes;\n","/**\n * @file: tag.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * tag structure.\n */\nimport DataViewReader from '../../util/dv';\nimport FlvTagTypes from '../../enum/flv-tag-types';\n\n/**\n * @extends DataViewReader\n */\nexport default class FlvTag extends DataViewReader {\n    tagType: number;\n    dataSize: number;\n    timestamp: number;\n    timestampExtended: number;\n    streamId: number;\n    payload: Uint8Array;\n    previousTagSize: number;\n    totalSize: number;\n\n    /**\n     * @param buffer\n     */\n    constructor(buffer: Uint8Array) {\n        super();\n\n        this.tagType = buffer[0];\n\n        this.dataSize = this.readUint32(buffer, 0) & 0x00ffffff;\n\n        let timestamp = this.readUint32(buffer, 3) & 0x00ffffff; // the lower 24 bits of the timestamp\n        let timestampExtended = buffer[7]; // This field represents the upper 8 bits of timestamp\n\n        this.timestamp = (timestampExtended << 24) + timestamp;\n\n        this.streamId = this.readUint32(buffer, 8) & 0x00ffffff; // Always 0\n\n        this.payload = buffer.subarray(11, 11 + this.dataSize);\n\n        this.previousTagSize = this.readUint32(buffer, 11 + this.dataSize);\n\n        this.totalSize = this.previousTagSize + 4;\n    }\n\n    valid(): boolean {\n        let { tagType, dataSize, previousTagSize } = this;\n        return (\n            previousTagSize === 11 + dataSize &&\n            (tagType === FlvTagTypes.SCRIPT_DATA || tagType === FlvTagTypes.VIDEO || tagType === FlvTagTypes.AUDIO)\n        );\n    }\n}\n","/**\n * @file: elementary.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport muxErrorCode from '../../mux-error-code';\nimport { Context, GlobalOptions } from '../../types/globals';\nimport CacheBuffer from '../../util/cache-buffer';\nimport logger from '../../util/logger';\nimport Stream from '../../util/stream';\nimport { HEAD_LEN, MIN_TAG_LEN, PREVIOUS_TAG_SIZE } from '../flv-const';\nimport FlvTag from '../structs/flv-tag';\nimport AVContext from '../types/av-context';\n\nclass BodyStream extends Stream {\n    private ctx_: Context;\n    private flv_: AVContext;\n    private options_: GlobalOptions;\n    private cache_buffer_: CacheBuffer;\n\n    constructor(ctx: Context, flvCtx: AVContext, options: GlobalOptions = {}) {\n        super();\n\n        this.ctx_ = ctx;\n        this.flv_ = flvCtx;\n        this.options_ = options;\n        this.cache_buffer_ = new CacheBuffer();\n    }\n\n    /**\n     * Push a body buffer\n     */\n    push(bodyBuffer: Uint8Array): void {\n        const { ctx_, flv_, cache_buffer_ } = this;\n        let buffer: Uint8Array | null;\n\n        cache_buffer_.append(bodyBuffer);\n\n        if (flv_.pos === HEAD_LEN) {\n            if (cache_buffer_.byteLength > PREVIOUS_TAG_SIZE + MIN_TAG_LEN) {\n                // drop PreviousTagSize0\n                cache_buffer_.cut(PREVIOUS_TAG_SIZE);\n\n                flv_.pos += PREVIOUS_TAG_SIZE;\n            }\n        }\n\n        while (cache_buffer_.byteLength > 0) {\n            // buffer start with tag\n            buffer = cache_buffer_.bytes;\n\n            if (buffer.length >= MIN_TAG_LEN) {\n                let tagHeadSize = 11; // 10 is tag header\n                let tagPayloadSize = (buffer[1] << 16) + (buffer[2] << 8) + buffer[3];\n                let previousTagSize = 4;\n                let tagSize = tagHeadSize + tagPayloadSize + previousTagSize;\n\n                if (buffer.length >= tagSize) {\n                    let tagBuffer = cache_buffer_.cut(tagSize);\n                    let tag = new FlvTag(tagBuffer);\n\n                    if (tag.valid()) {\n                        this.emit('data', tag);\n                        flv_.pos += tag.totalSize;\n                    } else {\n                        let errMsg = `Encounter invalid flv tag, tag_length(${tag.previousTagSize}), cache_length(${cache_buffer_.byteLength}), data(${tagBuffer})`;\n\n                        logger.error(errMsg);\n\n                        this.reset();\n\n                        ctx_.emit('error', muxErrorCode.TS_SYNC_BYTE, errMsg);\n                    }\n                } else {\n                    break;\n                }\n            } else {\n                break;\n            }\n        }\n    }\n\n    reset(): void {\n        const { cache_buffer_ } = this;\n\n        cache_buffer_.clear();\n        this.emit('reset');\n    }\n}\n\nexport default BodyStream;\n","/**\n * @file: created at Sunday, 24th May 2020 2:21:46 am\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport DataViewReader from '../../util/dv';\nimport logger from '../../util/logger';\n\nexport function AMFdeSerialize(data: Uint8Array) {\n    let result = {};\n    let item = parseData_(data);\n    result[item.key] = item.value;\n    return result;\n}\n\nfunction parseData_(source: Uint8Array, isString = false) {\n    let key = null,\n        value = null,\n        data = null;\n\n    if (isString) {\n        try {\n            data = new Uint8Array(source.length + 1);\n        } catch (e) {\n            logger.error(`flv parseData failed: ${e.message}`);\n        }\n        data[0] = 2;\n        data.set(source, 1, source.length);\n    } else {\n        data = source;\n    }\n    key = deSerialize_(data);\n    if (isString) {\n        key.valueLength -= 1;\n    }\n    let temp = source.subarray(key.valueLength, source.byteLength);\n    value = deSerialize_(temp);\n\n    return {\n        key: key.value,\n        value: value.value,\n        valueLength: key.valueLength + value.valueLength\n    };\n}\n\ntype SerializeResult = Partial<{\n    value: any;\n    valueLength: number;\n}>;\n\nfunction deSerialize_(data: Uint8Array) {\n    let result: SerializeResult = {};\n    let valueLength = 0;\n    let a = new DataViewReader();\n\n    switch (data[0]) {\n        case 0:\n            valueLength = 8;\n            result.value = uint8ToDouble_(data.subarray(1, 9));\n            result.valueLength = 1 + valueLength;\n            break;\n        case 1:\n            valueLength = 1;\n            result.value = data[1] !== 0;\n            result.valueLength = 1 + valueLength;\n            break;\n        case 2:\n            valueLength = (data[1] << 8) | data[2];\n            result.value = uint8ToStr_(data.subarray(3, 3 + valueLength));\n            result.valueLength = 1 + 2 + valueLength;\n            break;\n        case 3:\n            valueLength = 1;\n            result.value = {};\n            while (data[valueLength] != 0x00 || data[valueLength + 1] != 0x00 || data[valueLength + 2] != 0x09) {\n                let objData = data.subarray(valueLength, data.byteLength);\n                let item = parseData_(objData, true);\n                result.value[item.key] = item.value;\n                valueLength += item.valueLength;\n                objData = null;\n            }\n            valueLength += 3;\n            result.valueLength = valueLength;\n            break;\n        case 4:\n            valueLength = (data[1] << 8) | data[2];\n            result.value = uint8ToStr_(data.subarray(3, 3 + valueLength));\n            result.valueLength = 1 + 2 + valueLength;\n            break;\n        case 5:\n            result.value = null;\n            valueLength = 1;\n            result.valueLength = valueLength;\n            break;\n        case 6:\n            result.value = undefined;\n            valueLength = 1;\n            result.valueLength = valueLength;\n            break;\n        case 7:\n            result.value = a.readUint16(data, 1);\n            valueLength = 2 + 1;\n            result.valueLength = valueLength;\n            break;\n        case 8:\n            {\n                let arrLength = (data[1] << 24) | (data[2] << 16) | (data[3] << 8) | data[4];\n                valueLength = 1 + 4;\n                result.value = {};\n                for (let count = 0; count < arrLength; count++) {\n                    let itemData = data.subarray(valueLength, data.byteLength);\n                    let item2 = parseData_(itemData, true);\n                    result.value[item2.key] = item2.value;\n                    valueLength += item2.valueLength;\n                }\n                valueLength += 3;\n                result.valueLength = valueLength;\n            }\n            break;\n        case 9:\n            break;\n        case 10:\n            {\n                let arr = [];\n                let arrLength2 = a.readUint32(data, 1);\n                for (let i = 0; i < arrLength2; i++) {\n                    let objData2 = data.subarray(i * 9 + 4 + 1, data.byteLength);\n                    arr.push(deSerialize_(objData2).value);\n                }\n                result.value = arr;\n                valueLength = arr.length * 9 + 4 + 1;\n                result.valueLength = valueLength;\n            }\n            break;\n        case 11:\n            result.value = uint8ToDouble_(data.subarray(0, 8));\n            valueLength = 8 + 1 + 2;\n            result.valueLength = valueLength;\n            break;\n        case 12:\n            valueLength = (data[1] << 24) | (data[2] << 16) | (data[3] << 8) | data[4];\n            result.value = uint8ToStr_(data.subarray(5, 5 + valueLength));\n            result.valueLength = 1 + 4 + valueLength;\n            break;\n        default:\n            return null;\n    }\n    a = null;\n    return result;\n}\n\nfunction uint8ToStr_(data: Uint8Array) {\n    return String.fromCharCode.apply(null, data);\n}\n\nfunction uint8ToDouble_(data: Uint8Array) {\n    let temp = new Uint8Array(data);\n    let dv = new DataView(temp.buffer);\n    let str = dv.getFloat64(0);\n    dv = null;\n    temp = null;\n    return str;\n}\n","/**\n * @file: created at Saturday, 9th May 2020 4:38:35 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\nimport { AudioSpecificConfig } from '../../codec/aac/aac';\nimport { AVCDecoderConfigurationRecord } from '../../codec/avc';\nimport Stream from '../../util/stream';\nimport { FLVParseStage } from '../flv-const';\n\nexport enum AudioSoundFormat {\n    AAC = 10\n}\n\nexport enum AudioSoundType {\n    MONO = 0,\n    STEREO = 1 // For AAC: always 1\n}\n\nexport default class AVContext extends Stream {\n    stage: FLVParseStage;\n    pos: number = 0; // parse byte position relative to flv first byte;\n\n    version: number;\n    hasAudio: boolean;\n    hasVideo: boolean;\n\n    keyframeTimes: number[];\n    keyframeFilePositions: number[];\n\n    decoderConfigurationRecord: AVCDecoderConfigurationRecord;\n    audioSpecificConfig: AudioSpecificConfig;\n}\n","/**\n * @file: created at Monday, 25th May 2020 12:36:52 am\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * AVCVideoPacket structure.\n */\nimport { AudioSpecificConfig, AAC_SAMPLING_FREQUENCIES } from '../../codec/aac/aac';\nimport DataViewReader from '../../util/dv';\nimport logger from '../../util/logger';\n\n// 0: AAC sequence header\n// 1: AAC raw\nexport enum AACPacketType {\n    SEQUENCE_HEAD = 0, // 0 : AVCDecoderConfigurationRecord（AVC sequence header）\n    AAC_RAW = 1 // 1 : One or more NALUs (Full frames are required)\n}\n\n/**\n * ISO/IEC 14496-3 1.6.2.1 AudioSpecificConfig\n * @param buffer\n */\nexport function parseAudioSpecificConfig(buffer: Uint8Array): AudioSpecificConfig {\n    let LOG = 'AudioSpecificConfig';\n\n    // ISO/IEC 14496-3 Table 1.16 – Syntax of GetAudioObjectType()\n    let audioObjectType = buffer[0] >> 3;\n    if (audioObjectType == 31) {\n        logger.error(`${LOG} unsupported audioObjectType`);\n        // audioObjectType = 32 + audioObjectTypeExt;\n    }\n\n    let samplingFrequencyIndex = ((buffer[0] & 0x7) << 1) | (buffer[1] >> 7);\n    if (samplingFrequencyIndex === 0xf) {\n        logger.error(`${LOG} unsupported samplingFrequencyIndex`);\n    }\n    let channelConfiguration = (buffer[1] >> 3) & 0x0f;\n    if (channelConfiguration < 0 || channelConfiguration >= 8) {\n        logger.error('${LOG} unsupported channel configuration');\n    }\n\n    let sampleCount = ((buffer[1] >> 2) & 0x01) == 0 ? 1024 : 1024;\n    let sampleRate = AAC_SAMPLING_FREQUENCIES[samplingFrequencyIndex];\n\n    return {\n        audioObjectType,\n        samplingFrequencyIndex,\n        channelConfiguration,\n        sampleCount,\n        sampleRate\n    };\n}\n\n/**\n * @extends DataViewReader\n */\nexport default class AACAudioData extends DataViewReader {\n    dts: number;\n    pts: number;\n    aacPacketType: AACPacketType;\n    payload: Uint8Array;\n    audioSpecificConfig?: AudioSpecificConfig;\n\n    /**\n     * @param buffer\n     */\n    constructor(buffer: Uint8Array, timestamp: number) {\n        super();\n\n        this.dts = timestamp;\n        this.pts = timestamp;\n\n        this.aacPacketType = buffer[0];\n        this.payload = buffer.subarray(1);\n\n        if (this.aacPacketType === 0) {\n            this.audioSpecificConfig = parseAudioSpecificConfig(this.payload);\n        }\n    }\n}\n","/**\n * @file: created at Monday, 25th May 2020 2:51:52 am\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * audio data structure.\n */\nimport DataViewReader from '../../util/dv';\nimport logger from '../../util/logger';\nimport { AudioSoundFormat, AudioSoundType } from '../types/av-context';\nimport AACAudioData from './flv-tag-aac-audio-data';\n\n// 0 = Linear PCM, platform endian\n// 1 = ADPCM\n// 2 = MP3\n// 3 = Linear PCM, little endian\n// 4 = Nellymoser 16-kHz mono\n// 5 = Nellymoser 8-kHz mono\n// 6 = Nellymoser\n// 7 = G.711 A-law logarithmic PCM 8 = G.711 mu-law logarithmic PCM 9 = reserved\n// 10 = AAC\n// 11 = Speex\n// 14 = MP3 8-Khz\n// 15 = Device-specific sound\n\n/**\n * @extends DataViewReader\n */\nexport default class FlvTagAudioData extends DataViewReader {\n    soundFormat: AudioSoundFormat;\n    soundRate: number;\n    sampleSize: number; // Size of each sample\n    soundType: AudioSoundType;\n    soundData: AACAudioData;\n\n    /**\n     * @param buffer\n     */\n    constructor(buffer: Uint8Array, timestamp: number) {\n        super();\n\n        this.soundFormat = (buffer[0] & 0xf0) >> 4;\n        this.soundRate = (buffer[0] & 0x0c) >> 2;\n\n        let soundSize = (buffer[0] & 0x02) >> 1;\n\n        switch (soundSize) {\n            case 0:\n                this.sampleSize = 8; // bit\n                break;\n            case 1:\n                this.sampleSize = 16; // bit\n                break;\n        }\n        this.soundType = buffer[0] & 1;\n\n        switch (this.soundFormat) {\n            case AudioSoundFormat.AAC:\n                this.soundData = new AACAudioData(buffer.subarray(1), timestamp);\n                break;\n            default:\n                logger.error(`flv tag audioData encounter unknown soundFormat ${this.soundFormat}`);\n        }\n    }\n}\n","/**\n * @file: created at Monday, 25th May 2020 12:36:52 am\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * AVCVideoPacket structure.\n */\nimport { AVCCodec, AVCCodecData, AVCDecoderConfigurationRecord } from '../../codec/avc';\nimport NALU from '../../codec/avc/nalu';\nimport DataViewReader from '../../util/dv';\nimport logger from '../../util/logger';\nimport { PipelineContext } from '../types/flv-pipeline';\n\n// 0 : AVCDecoderConfigurationRecord（AVC sequence header）\n// 1 : One or more NALUs (Full frames are required)\n// 2 : AVC end of sequence\nexport enum AVCPacketTypes {\n    SEQUENCE_HEAD = 0, // 0 : AVCDecoderConfigurationRecord（AVC sequence header）\n    NALU = 1, // 1 : One or more NALUs (Full frames are required)\n    SEQUENCE_END = 2 // 2 : AVC end of sequence\n}\n\n/**\n * ISO/IEC 14496-15  5.2.4.1.1 Syntax\n * @param data\n */\nexport function parseAVCDecoderConfigurationRecord(data: Uint8Array): AVCDecoderConfigurationRecord {\n    let version = data[0];\n    let profile = data[1];\n    let profileCompatibility = data[2];\n    let level = data[3];\n    let naluSizeLength = 1 + (data[4] & 0x03);\n    let ppsNalus = [],\n        spsNalus = [];\n\n    let pos = 5;\n    let numOfSPS = data[pos] & 0x1f;\n\n    if (numOfSPS === 0) {\n        logger.error(`Flv: Invalid AVCDecoderConfigurationRecord: No SPS`);\n    } else if (numOfSPS > 0) {\n        if (numOfSPS > 1) {\n            logger.warn(`Flv: Strange AVCDecoderConfigurationRecord: SPS Count = ${numOfSPS}`);\n        }\n\n        pos++;\n        for (let i = 0; i < numOfSPS; i++) {\n            let spsDataLength = (data[pos] << 8) | data[pos + 1];\n            pos += 2;\n\n            spsNalus.push(data.subarray(pos, pos + spsDataLength));\n            pos += spsDataLength;\n        }\n    }\n\n    let numOfPPS = data[pos];\n\n    if (numOfPPS === 0) {\n        logger.error(`Flv: Invalid AVCDecoderConfigurationRecord: No PPS`);\n    } else if (numOfPPS > 0) {\n        if (numOfPPS > 1) {\n            logger.warn(`Flv: Strange AVCDecoderConfigurationRecord: PPS Count = ${numOfPPS}`);\n        }\n\n        pos++;\n        for (let i = 0; i < numOfPPS; i++) {\n            let ppsDataLength = (data[pos] << 8) | data[pos + 1];\n            pos += 2;\n\n            ppsNalus.push(data.subarray(pos, pos + ppsDataLength));\n            pos += ppsDataLength;\n        }\n    }\n\n    return {\n        version,\n        profile,\n        profileCompatibility,\n        level,\n        naluSizeLength,\n        spsNalus,\n        ppsNalus\n    };\n}\n\nconst avcCodec = new AVCCodec();\nconst naluList_: NALU[] = [];\n\navcCodec.on('nalu', (nalu: NALU) => {\n    naluList_.push(nalu);\n});\n\n/**\n * @extends DataViewReader\n */\nexport default class AVCVideoPacket extends DataViewReader {\n    avcPacketType: AVCPacketTypes;\n    decoderConfigurationRecord?: AVCDecoderConfigurationRecord;\n    cts: number;\n    pts: number;\n    dts: number;\n    payload: Uint8Array;\n    naluList?: NALU[];\n\n    private avcCodec?: AVCCodec;\n\n    /**\n     * @param buffer\n     */\n    constructor(pipeCtx: PipelineContext, buffer: Uint8Array, timestamp: number) {\n        super();\n\n        const { flv, options } = pipeCtx;\n\n        this.avcPacketType = buffer[0];\n\n        if (this.avcPacketType === 1) {\n            let cts_uint32 = this.readUint32(buffer, 0) & 0x00ffffff;\n            this.cts = (cts_uint32 << 8) >> 8; // convert to 24-bit signed int\n        } else {\n            this.cts = 0;\n        }\n\n        this.dts = timestamp;\n        this.pts = this.dts + this.cts;\n\n        this.payload = buffer.subarray(4);\n\n        if (this.avcPacketType === 0) {\n            this.decoderConfigurationRecord = parseAVCDecoderConfigurationRecord(this.payload);\n\n            flv.decoderConfigurationRecord = this.decoderConfigurationRecord;\n        } else {\n            if (options.decodeCodec) {\n                this.naluList = [];\n\n                let raw: AVCCodecData = {\n                    pts: this.pts,\n                    dts: this.dts,\n                    payload: this.payload\n                };\n\n                if (!this.decoderConfigurationRecord) {\n                    if (flv.decoderConfigurationRecord) {\n                        raw.naluSizeLength = flv.decoderConfigurationRecord.naluSizeLength;\n                    }\n\n                    avcCodec.push(raw);\n\n                    // Clone nalu to videoData\n                    for (let i = 0; i < naluList_.length; i++) {\n                        this.naluList.push(naluList_[i]);\n                    }\n\n                    // empty cache\n                    naluList_.splice(0, naluList_.length);\n                }\n            }\n        }\n    }\n}\n","/**\n * @file: tag.js, created at Monday, 23rd December 2019 3:47:23 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * video data structure.\n */\nimport DataViewReader from '../../util/dv';\nimport logger from '../../util/logger';\nimport { PipelineContext } from '../types/flv-pipeline';\nimport AVCVideoPacket from './flv-tag-avc-video-packet';\n\n// If CodecID == 2 H263VIDEOPACKET\n// If CodecID == 3 SCREENVIDEOPACKET\n// If CodecID == 4 VP6FLVVIDEOPACKET\n// If CodecID == 5 VP6FLVALPHAVIDEOPACKET\n// If CodecID == 6 SCREENV2VIDEOPACKET\n// if CodecID == 7 AVCVIDEOPACKET\n// Video frame payload or UI8 (see note following table)\n\nexport enum VideoCodecIDs {\n    AVC = 7 // AVC_VIDEO_PACKET\n}\n\n/**\n * @extends DataViewReader\n */\nexport default class FlvTagVideoData extends DataViewReader {\n    frameType: number;\n    isKeyframe: boolean;\n    codecId: VideoCodecIDs;\n    videoData: AVCVideoPacket;\n\n    /**\n     * @param buffer\n     */\n    constructor(pipeCtx: PipelineContext, buffer: Uint8Array, timestamp: number) {\n        super();\n\n        this.frameType = (buffer[0] >> 4) & 0x0f;\n        this.isKeyframe = this.frameType === 1;\n        this.codecId = buffer[0] & 0x0f;\n\n        switch (this.codecId) {\n            case VideoCodecIDs.AVC:\n                this.videoData = new AVCVideoPacket(pipeCtx, buffer.subarray(1), timestamp);\n                break;\n            default:\n                logger.error(`flv tag videoData encounter unknown codecId ${this.codecId}`);\n        }\n    }\n}\n","/**\n * @file: created at Saturday, 9th May 2020 3:49:22 pm\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * FLV Tags Stream.\n */\nimport FlvTagTypes from '../../enum/flv-tag-types';\nimport { Context, GlobalOptions } from '../../types/globals';\nimport logger from '../../util/logger';\nimport Stream from '../../util/stream';\nimport { AMFdeSerialize } from '../structs/flv-amf';\nimport FlvTag from '../structs/flv-tag';\nimport FlvTagAudioData from '../structs/flv-tag-audio-data';\nimport FlvTagVideoData from '../structs/flv-tag-video-data';\nimport AVContext from '../types/av-context';\nimport { PipelineContext, TagEmitData } from '../types/flv-pipeline';\n\nclass TagsStream extends Stream {\n    private flv_: AVContext;\n    private options_: GlobalOptions;\n    private pipeCtx: PipelineContext;\n\n    constructor(ctx: Context, flv: AVContext, options: GlobalOptions = {}) {\n        super();\n\n        this.flv_ = flv;\n        this.options_ = options;\n\n        this.pipeCtx = {\n            ctx,\n            flv,\n            options\n        };\n    }\n\n    push(tag: FlvTag) {\n        switch (tag.tagType) {\n            case FlvTagTypes.SCRIPT_DATA:\n                this.parseScriptData_(tag.payload);\n                break;\n            case FlvTagTypes.VIDEO:\n                this.parseVideoData_(tag);\n                break;\n            case FlvTagTypes.AUDIO:\n                this.parseAudioData_(tag);\n                break;\n            default:\n                logger.error(`still not supported flv tag type ${tag.tagType}`);\n        }\n    }\n\n    flush() {\n        const self = this;\n\n        self.emit('done');\n    }\n\n    reset() {\n        this.emit('reset');\n    }\n\n    private parseScriptData_(buffer: Uint8Array) {\n        const { flv_ } = this;\n        let result = AMFdeSerialize(buffer);\n\n        flv_.emit('data', {\n            type: 'tag',\n            tagType: FlvTagTypes.SCRIPT_DATA,\n            ...result\n        });\n    }\n\n    private parseVideoData_(tag: FlvTag) {\n        const { flv_ } = this;\n        const data = new FlvTagVideoData(this.pipeCtx, tag.payload, tag.timestamp);\n\n        let ret: TagEmitData = {\n            type: 'tag',\n            tagType: FlvTagTypes.VIDEO,\n            timestamp: tag.timestamp,\n            ...data\n        };\n\n        flv_.emit('data', ret);\n    }\n\n    private parseAudioData_(tag: FlvTag) {\n        const { /*options_,*/ flv_ } = this;\n\n        const data = new FlvTagAudioData(tag.payload, tag.timestamp);\n        const { /*sampleSize,*/ soundData } = data;\n\n        if (soundData.audioSpecificConfig) {\n            flv_.audioSpecificConfig = soundData.audioSpecificConfig;\n        } else {\n            // let stubTime = options_.config.stubTime;\n            // if (isNumber(stubTime)) {\n            // \tlet start = soundData.pts;\n            // \tlet duration =\n            // \t\tsoundData.pts +\n            // \t\tsoundData.payload.byteLength / (sampleSize / 8) / flv_.audioSpecificConfig.sampleCount;\n            // \tlet end = start + duration;\n            // \tif (end < stubTime) {\n            // \t\tlogger.warn(`drop aac tag, start/end/stubTime(${start}/${end}/${stubTime})`);\n            // \t\treturn;\n            // \t}\n            // }\n        }\n\n        let ret: TagEmitData = {\n            type: 'tag',\n            tagType: FlvTagTypes.AUDIO,\n            timestamp: tag.timestamp,\n            ...data\n        };\n\n        flv_.emit('data', ret);\n    }\n}\n\nexport default TagsStream;\n","/**\n * @file: created at Thursday, 14th May 2020 10:18:11 am\n * @copyright Copyright (c) 2020\n * @author gem <gems.xu@gmail.com>\n */\n\n/**\n * FLV Head Structure.\n */\nimport DataViewReader from '../../util/dv';\n\n/**\n * @extends DataViewReader\n */\nclass FlvHead extends DataViewReader {\n    signature: string;\n    version: number;\n    hasAudio: boolean;\n    hasVideo: boolean;\n    offset: number;\n\n    /**\n     * @param buffer\n     */\n    constructor(buffer: Uint8Array) {\n        super();\n\n        this.signature =\n            String.fromCharCode(buffer[0]) + // F\n            String.fromCharCode(buffer[1]) + // L\n            String.fromCharCode(buffer[2]); //V\n\n        this.version = buffer[3];\n        this.hasAudio = (buffer[4] & 4) >>> 2 == 1;\n        this.hasVideo = (buffer[4] & 1) == 1;\n        this.offset = this.readUint32(buffer, 5);\n    }\n\n    valid(): boolean {\n        return this.signature === 'FLV';\n    }\n}\n\nexport default FlvHead;\n","/**\n * flv demuxer.\n */\nimport DemuxFacade from '../demux-facade';\nimport muxErrorCode from '../mux-error-code';\nimport { GlobalOptions, PushConf } from '../types/globals';\nimport { isNumber } from '../util/is';\nimport logger from '../util/logger';\nimport { FLVParseStage, HEAD_LEN, MIN_BODY_LEN } from './flv-const';\nimport BodyStream from './streams/body';\nimport TagsStream from './streams/tag';\nimport FlvHead from './structs/flv-head';\nimport AVContext from './types/av-context';\n\n/**\n * flv\n */\nexport class FLVDemux extends DemuxFacade {\n    // private complex_: FlvComplex;\n    private flv_: AVContext;\n    private tags_: TagsStream;\n    private body_: BodyStream;\n\n    constructor(options: GlobalOptions = {}) {\n        super(options);\n\n        this.flv_ = new AVContext();\n        this.flv_.stage = FLVParseStage.HEAD;\n\n        // this. = 0;\n\n        this.body_ = new BodyStream(this.ctx_, this.flv_, options);\n        this.tags_ = new TagsStream(this.ctx_, this.flv_, options);\n\n        // Compose pipeline\n        this.pipe(this.body_);\n        this.body_.pipe(this.tags_);\n\n        super.listenEndStream_();\n    }\n\n    get endStream() {\n        return this.flv_;\n    }\n\n    /**\n     * @param buffer\n     * @param conf\n     * @param conf.offsetByte\n     */\n    push(buffer: ArrayBuffer | Uint8Array, conf: PushConf = {}) {\n        const { options_, ctx_, flv_, cache_buffer_ } = this;\n        const data: Uint8Array = super.constraintPushData_(buffer);\n        let cacheByteLength = this.cache_buffer_.byteLength;\n\n        logger.log(`flv demux received ${data.byteLength} bytes, cache ${cacheByteLength} bytes.`);\n\n        options_.config = conf;\n        if (isNumber(conf.offsetPos)) {\n            if (cacheByteLength === 0) {\n                if (flv_.pos !== conf.offsetPos) {\n                    ctx_.emit('error', muxErrorCode.FLV_NOT_EXPECTED_ADJACENT_DATA);\n                }\n\n                flv_.pos = conf.offsetPos;\n            }\n        }\n\n        cache_buffer_.append(data);\n\n        // if file byteOffset is provided, then specify the stage of parser.\n        if (flv_.pos < HEAD_LEN) {\n            flv_.stage === FLVParseStage.HEAD;\n        } else {\n            flv_.stage === FLVParseStage.BODY;\n        }\n\n        while (true) {\n            if (flv_.stage === FLVParseStage.HEAD) {\n                if (cache_buffer_.byteLength >= HEAD_LEN) {\n                    // has enough header\n                    let chunk = cache_buffer_.cut(HEAD_LEN);\n\n                    let head = new FlvHead(chunk);\n\n                    if (head.valid()) {\n                        flv_.emit('data', {\n                            type: 'head',\n                            signature: head.signature,\n                            version: head.version,\n                            hasAudio: head.hasAudio,\n                            hasVideo: head.hasVideo,\n                            offset: head.offset\n                        });\n\n                        // Change parse state -> body\n                        flv_.stage = FLVParseStage.BODY;\n                        flv_.pos = HEAD_LEN;\n                    } else {\n                        ctx_.emit('error', muxErrorCode.FLV_HEAD_SIGNATURE);\n                        break;\n                    }\n                } else {\n                    break;\n                }\n            } else if (flv_.stage === FLVParseStage.BODY) {\n                // At least has 4 body byte to parse\n                if (cache_buffer_.byteLength >= MIN_BODY_LEN) {\n                    let cbLen = cache_buffer_.byteLength;\n                    let nextBytes = cache_buffer_.bytes;\n\n                    cache_buffer_.clear();\n\n                    if (nextBytes) {\n                        this.emit('data', nextBytes);\n                    }\n\n                    flv_.pos += cbLen;\n                }\n\n                break;\n            }\n        }\n    }\n}\n"],"names":["Events","console","global","AVCStream","FlvTagTypes"],"mappings":"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"}